[{"path":"https://mrcieu.github.io/metaboprep/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 metaboprep authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://mrcieu.github.io/metaboprep/articles/batch_normalise.html","id":"create-metaboprep-object","dir":"Articles","previous_headings":"","what":"Create Metaboprep object","title":"Batch Normalise","text":"","code":"library(metaboprep)  data     <- read.csv(system.file(\"extdata\", \"dummy_data.csv\", package = \"metaboprep\"), header=T, row.names = 1) |> as.matrix() samples  <- read.csv(system.file(\"extdata\", \"dummy_samples.csv\", package = \"metaboprep\"), header=T, row.names = 1) features <- read.csv(system.file(\"extdata\", \"dummy_features.csv\", package = \"metaboprep\"), header=T, row.names = 1)  ## create Metaboprep object mydata <- Metaboprep(data = data, samples = samples, features = features)  ## summary of Metaboprep object summary(mydata) #> Metaboprep Object Summary #> -------------------------- #> Samples      : 100 #> Features     : 20 #> Data Layers  : 1 #> Layer Names  : input #>  #> Sample Summary Layers : none #> Feature Summary Layers: none #>  #> Sample Annotation (metadata): #>   Columns: 5 #>   Names  : sample_id, age, sex, pos, neg #>  #> Feature Annotation (metadata): #>   Columns: 5 #>   Names  : feature_id, platform, pathway, derived_feature, xenobiotic_feature #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 0 #> user_defined_sample_missingness   | 0 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 0"},{"path":"https://mrcieu.github.io/metaboprep/articles/batch_normalise.html","id":"run-batch-normalisation","dir":"Articles","previous_headings":"","what":"Run batch normalisation","title":"Batch Normalise","text":"","code":"mydata <- mydata |>   batch_normalise(run_mode_col = \"platform\", run_mode_colmap = c(pos=\"pos\", neg=\"neg\")) |>   print() #> <metaboprep::Metaboprep> #>  @ data           : num [1:100, 1:20, 1:2] 0.755887 0.662386 0.444527 0.627146 0.000465 ... #>  .. - attr(*, \"dimnames\")=List of 3 #>  ..  ..$ : chr [1:100] \"id_100\" \"id_99\" \"id_98\" \"id_97\" ... #>  ..  ..$ : chr [1:20] \"metab_id_1\" \"metab_id_2\" \"metab_id_3\" \"metab_id_4\" ... #>  ..  ..$ : chr [1:2] \"input\" \"batch_normalised\" #>  @ samples        :'data.frame': 100 obs. of  5 variables: #>  .. $ sample_id: chr  \"id_100\" \"id_99\" \"id_98\" \"id_97\" ... #>  .. $ age      : int  29 47 65 57 52 40 42 63 49 42 ... #>  .. $ sex      : chr  \"male\" \"male\" \"female\" \"female\" ... #>  .. $ pos      : chr  \"batch2\" \"batch1\" \"batch2\" \"batch1\" ... #>  .. $ neg      : chr  \"batch2\" \"batch2\" \"batch2\" \"batch1\" ... #>  @ features       :'data.frame': 20 obs. of  5 variables: #>  .. $ feature_id        : chr  \"metab_id_1\" \"metab_id_2\" \"metab_id_3\" \"metab_id_4\" ... #>  .. $ platform          : chr  \"neg\" \"neg\" \"neg\" \"pos\" ... #>  .. $ pathway           : logi  NA NA NA NA NA NA ... #>  .. $ derived_feature   : logi  TRUE FALSE FALSE FALSE FALSE FALSE ... #>  .. $ xenobiotic_feature: logi  FALSE FALSE FALSE FALSE FALSE FALSE ... #>  @ exclusions     :List of 2 #>  .. $ samples :List of 5 #>  ..  ..$ user_excluded                    : chr(0)  #>  ..  ..$ extreme_sample_missingness       : chr(0)  #>  ..  ..$ user_defined_sample_missingness  : chr(0)  #>  ..  ..$ user_defined_sample_totalpeakarea: chr(0)  #>  ..  ..$ user_defined_sample_pca_outlier  : chr(0)  #>  .. $ features:List of 3 #>  ..  ..$ user_excluded                   : chr(0)  #>  ..  ..$ extreme_feature_missingness     : chr(0)  #>  ..  ..$ user_defined_feature_missingness: chr(0)  #>  @ feature_summary: num[0 , 0 , 0 ]  #>  @ sample_summary : num[0 , 0 , 0 ]"},{"path":[]},{"path":"https://mrcieu.github.io/metaboprep/articles/batch_normalise.html","id":"raw-input-data","dir":"Articles","previous_headings":"Accessing data","what":"Raw input data","title":"Batch Normalise","text":"","code":"mydata@data[1:5, 1:5, \"input\"] #>          metab_id_1 metab_id_2 metab_id_3 metab_id_4 metab_id_5 #> id_100 0.7558872597 0.42346365  0.2830023  0.8074991 0.52739494 #> id_99  0.6623855066 0.94958532  0.4204349  0.1280644 0.86098936 #> id_98  0.4445273969 0.70903790  0.5872781  0.2507785 0.67355499 #> id_97  0.6271461844 0.41330541  0.8066944  0.3315470 0.01304103 #> id_96  0.0004653491 0.01836408  0.2019952  0.4072693 0.69319890"},{"path":"https://mrcieu.github.io/metaboprep/articles/batch_normalise.html","id":"batch-normlalised-data","dir":"Articles","previous_headings":"Accessing data","what":"Batch normlalised data","title":"Batch Normalise","text":"","code":"mydata@data[1:5, 1:5, \"batch_normalised\"] #>          metab_id_1 metab_id_2 metab_id_3 metab_id_4 metab_id_5 #> id_100 1.2219122932 0.85292184  0.5567470  2.0502351  0.9094521 #> id_99  1.0707641687 1.91261295  0.8271164  0.2650566  1.4847101 #> id_98  0.7185906152 1.42811293  1.1553450  0.6367251  1.1614939 #> id_97  1.3714905954 0.71888003  1.6124149  0.6862071  0.0243190 #> id_96  0.0007522494 0.03698813  0.3973827  0.8429306  1.1953683"},{"path":[]},{"path":"https://mrcieu.github.io/metaboprep/articles/export.html","id":"load-the-metaboprep-library","dir":"Articles","previous_headings":"Setup","what":"load the metaboprep library","title":"Export Data","text":"","code":"library(metaboprep)"},{"path":"https://mrcieu.github.io/metaboprep/articles/export.html","id":"read-in-the-data-and-make-a-metaboprep-object","dir":"Articles","previous_headings":"Setup","what":"Read in the data and make a Metaboprep object","title":"Export Data","text":"Create Metaboprep object described Getting Started vignette.","code":"# read in the metabolon data as a list object datain     <- read_metabolon(system.file(\"extdata\", \"metabolon_v1.1_example.xlsx\", package = \"metaboprep\"),                              sheet=\"OrigScale\",                              return_Metaboprep = FALSE)  # build the Metaboprep class object mydata      <- Metaboprep(data = datain$data, samples = datain$samples, features = datain$features)"},{"path":"https://mrcieu.github.io/metaboprep/articles/export.html","id":"run-the-quality-control","dir":"Articles","previous_headings":"","what":"Run the quality control","title":"Export Data","text":"","code":"## Adding suppressWarnings() to avoid deparse() error when rendering vignette with S7 method warnings mydata         <- suppressWarnings( quality_control(mydata) ) #>  #> ── Starting Metabolite QC Process ────────────────────────────────────────────── #> ℹ Validating input parameters #> ✔ Validating input parameters [12ms] #>  #> ℹ Sample & Feature Summary Statistics for raw data #> ✔ Sample & Feature Summary Statistics for raw data [912ms] #>  #> ℹ Copying input data to new 'qc' data layer #> ✔ Copying input data to new 'qc' data layer [36ms] #>  #> ℹ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) #> ✔ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) [17ms] #>  #> ℹ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) #> ✔ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) [16m… #>  #> ℹ Assessing for sample missingness at specified level of >=20% - excluding 0 sa… #> ✔ Assessing for sample missingness at specified level of >=20% - excluding 2 sa… #>  #> ℹ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #> ✔ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #>  #> ℹ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #> ✔ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #>  #> ℹ Running sample data PCA outlier analysis at +/- 5 Sdev #> ✔ Running sample data PCA outlier analysis at +/- 5 Sdev [17ms] #>  #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #> ! The stated max PCs [max_num_pcs=10] to use in PCA outlier assessment is greater than the number of available informative PCs [2] #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier…✔ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #>  #> ℹ Creating final QC dataset... #> ✔ Creating final QC dataset... [856ms] #>  #> ℹ Metabolite QC Process Completed #> ✔ Metabolite QC Process Completed [24ms]"},{"path":"https://mrcieu.github.io/metaboprep/articles/export.html","id":"export-metaboprep","dir":"Articles","previous_headings":"","what":"Export Metaboprep","title":"Export Data","text":"","code":"# where to put the files output_dir <- file.path(getwd(), \"output\")  # run export export(mydata, directory = output_dir, format = \"metaboprep\") #> Exporting in metaboprep format to:  #>      /home/runner/work/metaboprep/metaboprep/vignettes/output  # view output directory files files <- list.files(output_dir, full.names = TRUE, recursive = TRUE) unname(sapply(files, function(path) {   parts <- strsplit(path, .Platform$file.sep)[[1]]   paste(tail(parts, 4), collapse = .Platform$file.sep) })) #>  [1] \"output/metaboprep_export_2025_11_11/input/config.yml\"          #>  [2] \"output/metaboprep_export_2025_11_11/input/data.tsv\"            #>  [3] \"output/metaboprep_export_2025_11_11/input/feature_summary.tsv\" #>  [4] \"output/metaboprep_export_2025_11_11/input/features.tsv\"        #>  [5] \"output/metaboprep_export_2025_11_11/input/sample_summary.tsv\"  #>  [6] \"output/metaboprep_export_2025_11_11/input/samples.tsv\"         #>  [7] \"output/metaboprep_export_2025_11_11/qc/config.yml\"             #>  [8] \"output/metaboprep_export_2025_11_11/qc/data.tsv\"               #>  [9] \"output/metaboprep_export_2025_11_11/qc/feature_summary.tsv\"    #> [10] \"output/metaboprep_export_2025_11_11/qc/feature_tree.RDS\"       #> [11] \"output/metaboprep_export_2025_11_11/qc/features.tsv\"           #> [12] \"output/metaboprep_export_2025_11_11/qc/sample_summary.tsv\"     #> [13] \"output/metaboprep_export_2025_11_11/qc/samples.tsv\"            #> [14] \"output/metaboprep_export_2025_11_11/qc/var_exp.tsv\""},{"path":"https://mrcieu.github.io/metaboprep/articles/feature_summary.html","id":"create-metaboprep-object","dir":"Articles","previous_headings":"","what":"Create Metaboprep object","title":"Feature summary","text":"","code":"library(metaboprep)  # import data data     <- read.csv(system.file(\"extdata\", \"dummy_data.csv\",     package = \"metaboprep\"), header=T, row.names = 1) |> as.matrix() samples  <- read.csv(system.file(\"extdata\", \"dummy_samples.csv\",  package = \"metaboprep\"), header=T, row.names = 1) features <- read.csv(system.file(\"extdata\", \"dummy_features.csv\", package = \"metaboprep\"), header=T, row.names = 1)  # create object mydata <- Metaboprep(data = data, samples = samples, features = features)"},{"path":"https://mrcieu.github.io/metaboprep/articles/feature_summary.html","id":"summary-of-metaboprep-object","dir":"Articles","previous_headings":"","what":"Summary of Metaboprep object","title":"Feature summary","text":"","code":"summary(mydata) #> Metaboprep Object Summary #> -------------------------- #> Samples      : 100 #> Features     : 20 #> Data Layers  : 1 #> Layer Names  : input #>  #> Sample Summary Layers : none #> Feature Summary Layers: none #>  #> Sample Annotation (metadata): #>   Columns: 5 #>   Names  : sample_id, age, sex, pos, neg #>  #> Feature Annotation (metadata): #>   Columns: 5 #>   Names  : feature_id, platform, pathway, derived_feature, xenobiotic_feature #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 0 #> user_defined_sample_missingness   | 0 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 0"},{"path":"https://mrcieu.github.io/metaboprep/articles/feature_summary.html","id":"run-feature-summary","dir":"Articles","previous_headings":"","what":"Run feature summary","title":"Feature summary","text":"","code":"# note that for illustrative purposes we are using a log outlier unit distance of 1.0 here, in practice we tend to favor a value of 5.0. feature_sum1 <- feature_summary(metaboprep     = mydata,                                  source_layer    = \"input\",                                  outlier_udist   = 1.0,                                 tree_cut_height = 0.5,                                 output          = \"data.frame\")"},{"path":[]},{"path":"https://mrcieu.github.io/metaboprep/articles/feature_summary.html","id":"feature-summary-attributes","dir":"Articles","previous_headings":"","what":"Feature summary attributes","title":"Feature summary","text":"addition summary data, hierarchical cluster dendrogram appended returned data.frame attribute. can accessed attribute name: [source_layer]_tree, case summarised input data, therefore attribute name input_tree.","code":"suppressPackageStartupMessages(library(dendextend))  # extract tree from attributes tree <- attr(feature_sum1, 'input_tree') dend <- stats::as.dendrogram(tree)  # color the independent features blue metab_color       <- feature_sum1[, c(\"feature_id\", \"independent_features\")] metab_color       <- metab_color[match(labels(dend), metab_color$feature_id), ] metab_color$color <- ifelse(metab_color$independent_features==TRUE, \"#477EB8\", \"grey\")  # format dendrogram for ploting dend <- dend |>   dendextend::set(\"labels_cex\", 0.75) |>   dendextend::set(\"labels_col\", metab_color$color) |>   dendextend::set(\"branches_lwd\", 1) |>   dendextend::set(\"branches_k_color\",  value = metab_color$color)  ## plot the dendrogram dend |> plot(main = \"Feature clustering dendrogram\") abline(h = 0.5, col = \"#E41A1C\", lwd = 1.5)"},{"path":"https://mrcieu.github.io/metaboprep/articles/feature_summary.html","id":"run-feature-summary-on-subset","dir":"Articles","previous_headings":"","what":"Run feature summary on subset","title":"Feature summary","text":"Using sample_ids feature_ids arguments can run summary subset data. Note: rows return, however summary data returned specified ids.","code":"## define a vector of sample IDs sids <- mydata@samples[mydata@samples$sex == \"female\", \"sample_id\"]   ## define a vector of feature IDs fids <- mydata@features[, \"feature_id\"] |> sample(10)  # note that for illustrative purposes we are using a log outlier unit distance of 1.0 here, in practice we tend to favor a value of 5.0. feature_sum_subset <- feature_summary(metaboprep      = mydata,                                        source_layer    = \"input\",                                        outlier_udist   = 1.0,                                       tree_cut_height = 0.5,                                       sample_ids      = sids,                                       feature_ids     = fids,                                       output          = \"data.frame\")"},{"path":[]},{"path":"https://mrcieu.github.io/metaboprep/articles/feature_summary.html","id":"run-sample-feature-summaries-together","dir":"Articles","previous_headings":"","what":"Run sample & feature summaries together","title":"Feature summary","text":"","code":"# note that for illustrative purposes we are using a log outlier unit distance of 1.0 here, in practice we tend to favor a value of 5.0. sam_n_feat_sum <- summarise(metaboprep      = mydata,                              source_layer    = \"input\",                              outlier_udist   = 1.0,                             tree_cut_height = 0.5,                             sample_ids      = sids,                              feature_ids     = fids,                             output          = \"data.frame\")"},{"path":[]},{"path":"https://mrcieu.github.io/metaboprep/articles/generate_report.html","id":"import-example-metabolomics-data","dir":"Articles","previous_headings":"","what":"Import example metabolomics data","title":"Generate QC Report","text":"","code":"library(metaboprep)  # import data directly as a Metaboprep object mydata <- read_metabolon(system.file(\"extdata\", \"metabolon_v1.1_example.xlsx\", package = \"metaboprep\"),                           sheet=\"OrigScale\",                          return_Metaboprep = TRUE)"},{"path":"https://mrcieu.github.io/metaboprep/articles/generate_report.html","id":"identify-the-xenobiotics-to-exclude-from-the-qc-steps","dir":"Articles","previous_headings":"","what":"Identify the Xenobiotics to exclude from the QC steps","title":"Generate QC Report","text":"","code":"xenos <- mydata@features[mydata@features$pathway == \"xenobiotic\", \"feature_id\"]  ## how many xenobiotics identified length(xenos) #> [1] 3"},{"path":"https://mrcieu.github.io/metaboprep/articles/generate_report.html","id":"qc-the-example-metabolon-data","dir":"Articles","previous_headings":"","what":"QC the example Metabolon data","title":"Generate QC Report","text":"","code":"mydata <- mydata |>   quality_control(source_layer        = \"input\",                    sample_missingness  = 0.2,                    feature_missingness = 0.2,                    total_peak_area_sd  = 5,                    outlier_udist       = 5,                    outlier_treatment   = \"leave_be\",                    winsorize_quantile  = 1.0,                    tree_cut_height     = 0.5,                    pc_outlier_sd       = 5,                   feature_selection   = \"least_missingness\",                    features_exclude_but_keep = xenos                    ) #>  #> ── Starting Metabolite QC Process ────────────────────────────────────────────── #> ℹ Validating input parameters #> ✔ Validating input parameters [13ms] #>  #> ℹ Excluding 0 features from sample summary analysis but keeping in output data #> ✔ Excluding 3 features from sample summary analysis but keeping in output data … #>  #> ℹ Sample & Feature Summary Statistics for raw data #> ✔ Sample & Feature Summary Statistics for raw data [855ms] #>  #> ℹ Copying input data to new 'qc' data layer #> ✔ Copying input data to new 'qc' data layer [29ms] #>  #> ℹ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) #> ✔ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) [17ms] #>  #> ℹ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) #> ✔ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) [17m… #>  #> ℹ Assessing for sample missingness at specified level of >=20% - excluding 0 sa… #> ✔ Assessing for sample missingness at specified level of >=20% - excluding 2 sa… #>  #> ℹ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #> ✔ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #>  #> ℹ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #> ✔ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #>  #> ℹ Running sample data PCA outlier analysis at +/- 5 Sdev #> ✔ Running sample data PCA outlier analysis at +/- 5 Sdev [17ms] #>  #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #> ! The stated max PCs [max_num_pcs=10] to use in PCA outlier assessment is greater than the number of available informative PCs [2] #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier…✔ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #>  #> ℹ Creating final QC dataset... #> ✔ Creating final QC dataset... [831ms] #>  #> ℹ Metabolite QC Process Completed #> ✔ Metabolite QC Process Completed [31ms]"},{"path":"https://mrcieu.github.io/metaboprep/articles/generate_report.html","id":"generate-the-metaboprep-report","dir":"Articles","previous_headings":"","what":"Generate the metaboprep report","title":"Generate QC Report","text":"","code":"# render report generate_report(mydata,                 project         = \"myproject\",                 output_dir      = getwd(),                 output_filename = NULL,                 format          = \"html\",                 template        = \"qc_report\") #> processing file: skeleton.Rmd #> Warning in call_block(x): The chunk 'unnamed-chunk-1' has the 'child' option, #> and this code chunk must be empty. Its code will be ignored. #> Warning in call_block(x): The chunk 'unnamed-chunk-2' has the 'child' option, #> and this code chunk must be empty. Its code will be ignored. #> Warning in call_block(x): The chunk 'unnamed-chunk-3' has the 'child' option, #> and this code chunk must be empty. Its code will be ignored. #> output file: /home/runner/work/metaboprep/metaboprep/vignettes/skeleton.knit.md #> /opt/hostedtoolcache/pandoc/3.1.11/x64/pandoc +RTS -K512m -RTS /home/runner/work/metaboprep/metaboprep/vignettes/skeleton.knit.md --to html4 --from markdown+autolink_bare_uris+tex_math_single_backslash --output /home/runner/work/metaboprep/metaboprep/vignettes/myproject_metaboprep_qc_report.html --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/pagebreak.lua --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/latex-div.lua --embed-resources --standalone --variable bs3=TRUE --section-divs --table-of-contents --toc-depth 2 --template /home/runner/work/_temp/Library/rmarkdown/rmd/h/default.html --no-highlight --variable highlightjs=1 --number-sections --variable theme=bootstrap --css styles.css --mathjax --variable 'mathjax-url=https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML' --include-in-header /tmp/RtmpuMA7N4/rmarkdown-str22f663ecfaa2.html #>  #> Output created: myproject_metaboprep_qc_report.html #> [1] TRUE"},{"path":"https://mrcieu.github.io/metaboprep/articles/metabolon.html","id":"import-metabolon-data","dir":"Articles","previous_headings":"","what":"Import Metabolon data","title":"Import Metabolon Metabolomic Data","text":"Read Metabolon data using read_metabolon function. read example data provided package, list object.","code":"library(metaboprep)  # example file filepath <- system.file(\"extdata\", \"metabolon_v1.2_example.xlsx\", package = \"metaboprep\")  # import data as a list object rather than directly as a Metaboprep object dat <- read_metabolon(filepath,                        sheet = 'OrigScale',                        return_Metaboprep = FALSE)"},{"path":"https://mrcieu.github.io/metaboprep/articles/metabolon.html","id":"quick-look-at-data-structure-of-the-imported-data","dir":"Articles","previous_headings":"","what":"Quick look at data structure of the imported data","title":"Import Metabolon Metabolomic Data","text":"","code":"str(dat) #> List of 3 #>  $ data    : num [1:100, 1:104] 98551 43695 44899 37811 36825 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:100] \"ind1\" \"ind2\" \"ind3\" \"ind4\" ... #>   .. ..$ : chr [1:104] \"123\" \"124\" \"125\" \"126\" ... #>  $ samples :'data.frame':    100 obs. of  5 variables: #>   ..$ sample_id        : chr [1:100] \"ind1\" \"ind2\" \"ind3\" \"ind4\" ... #>   ..$ parent_sample_id : chr [1:100] \"ps_id\" \"ps_id\" \"ps_id\" \"ps_id\" ... #>   ..$ client_identifier: chr [1:100] \"FR01234\" \"FR01235\" \"FR01236\" \"FR01237\" ... #>   ..$ pair             : chr [1:100] \"99999\" \"99999\" \"99999\" \"99999\" ... #>   ..$ volume_extracted : chr [1:100] \"100\" \"100\" \"100\" \"100\" ... #>  $ features:'data.frame':    104 obs. of  14 variables: #>   ..$ feature_id       : chr [1:104] \"123\" \"124\" \"125\" \"126\" ... #>   ..$ pathway_sortorder: chr [1:104] \"1\" \"2\" \"3\" \"4\" ... #>   ..$ biochemical      : chr [1:104] \"(N(1) + N(8))-acetylspermidine\" \"1,2,3-benzenetriol sulfate (2)\" \"1,2-dilinoleoyl-GPC (18:2/18:2)\" \"1,2-dilinoleoyl-GPE (18:2/18:2)*\" ... #>   ..$ super_pathway    : chr [1:104] \"Amino Acid\" \"Xenobiotics\" \"Lipid\" \"Lipid\" ... #>   ..$ sub_pathway      : chr [1:104] \"Polyamine Metabolism\" \"Chemical\" \"Phosphatidylcholine (PC)\" \"Phosphatidylethanolamine (PE)\" ... #>   ..$ comp_id          : chr [1:104] \"123\" \"124\" \"125\" \"126\" ... #>   ..$ platform         : chr [1:104] \"LC/MS Pos Early\" \"LC/MS Neg\" \"LC/MS Pos Late\" \"LC/MS Pos Late\" ... #>   ..$ chemical_id      : chr [1:104] \"1111\" \"1112\" \"1113\" \"1114\" ... #>   ..$ ri               : chr [1:104] \"2221\" \"2222\" \"2223\" \"2224\" ... #>   ..$ mass             : chr [1:104] \"111.111\" \"111.11199999999999\" \"111.113\" \"111.114\" ... #>   ..$ cas              : chr [1:104] NA NA \"111-11-1\" NA ... #>   ..$ pubchem          : chr [1:104] NA NA \"11111\" \"11112\" ... #>   ..$ kegg             : chr [1:104] NA NA NA NA ... #>   ..$ group_hmdb       : chr [1:104] NA NA \"HMDB123\" \"HMDB124\" ..."},{"path":"https://mrcieu.github.io/metaboprep/articles/metabolon.html","id":"create-metaboprep-object","dir":"Articles","previous_headings":"","what":"Create Metaboprep object","title":"Import Metabolon Metabolomic Data","text":"imported, pass data Metaboprep() function build Metaboprep class object.","code":"## This step could be avoided by defining return_Metaboprep = TRUE in read_metabolon() function above. mydata <- Metaboprep(data     = dat$data,                       features = dat$features,                       samples  = dat$samples)"},{"path":"https://mrcieu.github.io/metaboprep/articles/metabolon.html","id":"quick-summary-of-the-metaboprep-object","dir":"Articles","previous_headings":"","what":"Quick summary of the metaboprep object","title":"Import Metabolon Metabolomic Data","text":"","code":"summary(mydata) #> Metaboprep Object Summary #> -------------------------- #> Samples      : 100 #> Features     : 104 #> Data Layers  : 1 #> Layer Names  : input #>  #> Sample Summary Layers : none #> Feature Summary Layers: none #>  #> Sample Annotation (metadata): #>   Columns: 5 #>   Names  : sample_id, parent_sample_id, client_identifier, pair, volume_extracted #>  #> Feature Annotation (metadata): #>   Columns: 14 #>   Names  : feature_id, pathway_sortorder, biochemical, super_pathway, sub_pathway, comp_id, platform, chemical_id, ri, mass, cas, pubchem, kegg, group_hmdb #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 0 #> user_defined_sample_missingness   | 0 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 0"},{"path":"https://mrcieu.github.io/metaboprep/articles/metabolon.html","id":"identify-the-xenobiotics-to-exclude-from-the-qc-steps","dir":"Articles","previous_headings":"","what":"Identify the Xenobiotics to exclude from the QC steps","title":"Import Metabolon Metabolomic Data","text":"Use feature data just imported identify xenobiotic metabolites. may best excluded features quality-control (QC) process. Xenobiotics typically exhibit much higher levels missingness endogenous metabolites, including QC can result excessive exclusion features samples. step allow retain features final dataset, excluding QC filtering steps.","code":"xenos <- mydata@features[!is.na(mydata@features$super_pathway) &                             mydata@features$super_pathway == \"Xenobiotics\", \"feature_id\"]  ## how many xenobiotics identified length(xenos) #> [1] 7"},{"path":"https://mrcieu.github.io/metaboprep/articles/metabolon.html","id":"qc-metabolon","dir":"Articles","previous_headings":"","what":"QC Metabolon","title":"Import Metabolon Metabolomic Data","text":"Perform QC steps using quality_control function, specifying xenobiotics exclude QC steps.","code":"## Given the high missingness in metabolon data,  ##   we suggest using the `least_missingness` feature selection method ##   for the identification of principle variable that will then be  ##   used in the construction of PCs.   mydata <- mydata |>   quality_control(source_layer        = \"input\",                    sample_missingness  = 0.2,                    feature_missingness = 0.2,                    total_peak_area_sd  = 5,                    outlier_udist       = 5,                    outlier_treatment   = \"leave_be\",                    winsorize_quantile  = 1.0,                    tree_cut_height     = 0.5,                    pc_outlier_sd       = 5,                   feature_selection   = \"least_missingness\", ## We suggest using `least_missingness` when working with data, like Metabolon, with high missingness. Default is \"max_var_exp\".                   features_exclude_but_keep = xenos ## exclude xenobiotics from QC, but retain them in the final dataset                   ) #>  #> ── Starting Metabolite QC Process ────────────────────────────────────────────── #> ℹ Validating input parameters #> ✔ Validating input parameters [8ms] #>  #> ℹ Excluding 0 features from sample summary analysis but keeping in output data #> ✔ Excluding 7 features from sample summary analysis but keeping in output data … #>  #> ℹ Sample & Feature Summary Statistics for raw data #> ✔ Sample & Feature Summary Statistics for raw data [1.2s] #>  #> ℹ Copying input data to new 'qc' data layer #> ✔ Copying input data to new 'qc' data layer [20ms] #>  #> ℹ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) #> ✔ Assessing for extreme sample missingness >=80% - excluding 1 sample(s) [16ms] #>  #> ℹ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) #> ✔ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) [18m… #>  #> ℹ Assessing for sample missingness at specified level of >=20% - excluding 0 sa… #> ✔ Assessing for sample missingness at specified level of >=20% - excluding 0 sa… #>  #> ℹ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #> ✔ Assessing for feature missingness at specified level of >=20% - excluding 1 f… #>  #> ℹ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #> ✔ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #>  #> ℹ Running sample data PCA outlier analysis at +/- 5 Sdev #> ✔ Running sample data PCA outlier analysis at +/- 5 Sdev [22ms] #>  #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #> ! The stated max PCs [max_num_pcs=10] to use in PCA outlier assessment is greater than the number of available informative PCs [2] #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier…✔ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #>  #> ℹ Creating final QC dataset... #> ✔ Creating final QC dataset... [1.3s] #>  #> ℹ Metabolite QC Process Completed #> ✔ Metabolite QC Process Completed [21ms]"},{"path":"https://mrcieu.github.io/metaboprep/articles/metabolon.html","id":"quick-summary-of-the-metaboprep-object-following-qc","dir":"Articles","previous_headings":"","what":"Quick summary of the metaboprep object following QC","title":"Import Metabolon Metabolomic Data","text":"","code":"summary(mydata) #> Metaboprep Object Summary #> -------------------------- #> Samples      : 100 #> Features     : 104 #> Data Layers  : 2 #> Layer Names  : input, qc #>  #> Sample Summary Layers : input, qc #> Feature Summary Layers: input, qc #>  #> Sample Annotation (metadata): #>   Columns: 7 #>   Names  : sample_id, parent_sample_id, client_identifier, pair, volume_extracted, reason_excluded, excluded #>  #> Feature Annotation (metadata): #>   Columns: 16 #>   Names  : feature_id, pathway_sortorder, biochemical, super_pathway, sub_pathway, comp_id, platform, chemical_id, ri, mass, cas, pubchem, kegg, group_hmdb, reason_excluded, excluded #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 1 #> user_defined_sample_missingness   | 0 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 1"},{"path":"https://mrcieu.github.io/metaboprep/articles/nightingale.html","id":"import-nightingale-data-directly-into-a-metaboprep-object","dir":"Articles","previous_headings":"","what":"Import Nightingale data directly into a Metaboprep object","title":"Import Nightingale Metabolomic Data","text":"Read Nightingale Health data using read_nightingale function. read example data provided package, convert directly Metaboprep S7 object.","code":"library(metaboprep)  # example file filepath <- system.file(\"extdata\", \"nightingale_v2_example.xlsx\", package = \"metaboprep\")  # import mydata <- read_nightingale(filepath, return_Metaboprep = TRUE)"},{"path":"https://mrcieu.github.io/metaboprep/articles/nightingale.html","id":"quick-look-at-data-structure-of-the-imported-data","dir":"Articles","previous_headings":"","what":"Quick look at data structure of the imported data","title":"Import Nightingale Metabolomic Data","text":"","code":"str(mydata) #> <metaboprep::Metaboprep> #>  @ data           : num [1:50, 1:15, 1] 2.84e-10 3.86e-11 9.59e-11 2.21e-10 1.24e-10 ... #>  .. - attr(*, \"dimnames\")=List of 3 #>  ..  ..$ : chr [1:50] \"ind1\" \"ind2\" \"ind3\" \"ind4\" ... #>  ..  ..$ : chr [1:15] \"XXL-VLDL-P\" \"XXL-VLDL-L\" \"XXL-VLDL-PL\" \"XXL-VLDL-C\" ... #>  ..  ..$ : chr \"input\" #>  @ samples        :'data.frame': 50 obs. of  5 variables: #>  .. $ sample_id                    : chr  \"ind1\" \"ind2\" \"ind3\" \"ind4\" ... #>  .. $ high_pyruvate                : int  0 0 0 0 0 0 0 0 0 0 ... #>  .. $ high_lactate                 : int  0 0 0 0 0 0 0 1 0 0 ... #>  .. $ low_glutamine__high_glutamate: int  0 0 0 0 0 0 0 0 0 0 ... #>  .. $ plasma_sample                : int  0 0 0 0 0 0 0 0 0 0 ... #>  @ features       :'data.frame': 15 obs. of  1 variable: #>  .. $ feature_id: chr  \"XXL-VLDL-P\" \"XXL-VLDL-L\" \"XXL-VLDL-PL\" \"XXL-VLDL-C\" ... #>  @ exclusions     :List of 2 #>  .. $ samples :List of 5 #>  ..  ..$ user_excluded                    : chr(0)  #>  ..  ..$ extreme_sample_missingness       : chr(0)  #>  ..  ..$ user_defined_sample_missingness  : chr(0)  #>  ..  ..$ user_defined_sample_totalpeakarea: chr(0)  #>  ..  ..$ user_defined_sample_pca_outlier  : chr(0)  #>  .. $ features:List of 3 #>  ..  ..$ user_excluded                   : chr(0)  #>  ..  ..$ extreme_feature_missingness     : chr(0)  #>  ..  ..$ user_defined_feature_missingness: chr(0)  #>  @ feature_summary: num[0 , 0 , 0 ]  #>  @ sample_summary : num[0 , 0 , 0 ]"},{"path":"https://mrcieu.github.io/metaboprep/articles/nightingale.html","id":"qc-nightingale","dir":"Articles","previous_headings":"","what":"QC Nightingale","title":"Import Nightingale Metabolomic Data","text":"Perform QC steps using quality_control function.","code":"mydata <- mydata |>   quality_control(source_layer        = \"input\",                    sample_missingness  = 0.2,                    feature_missingness = 0.2,                    total_peak_area_sd  = 5,                    outlier_udist       = 5,                    outlier_treatment   = \"leave_be\",                    winsorize_quantile  = 1.0,                    tree_cut_height     = 0.5,                    pc_outlier_sd       = 5,                    feature_selection   = \"max_var_exp\",                   features_exclude_but_keep = NULL                   ) #>  #> ── Starting Metabolite QC Process ────────────────────────────────────────────── #> ℹ Validating input parameters #> ✔ Validating input parameters [8ms] #>  #> ℹ Sample & Feature Summary Statistics for raw data #> ✔ Sample & Feature Summary Statistics for raw data [191ms] #>  #> ℹ Copying input data to new 'qc' data layer #> ✔ Copying input data to new 'qc' data layer [22ms] #>  #> ℹ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) #> ✔ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) [16ms] #>  #> ℹ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) #> ✔ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) [20m… #>  #> ℹ Assessing for sample missingness at specified level of >=20% - excluding 0 sa… #> ✔ Assessing for sample missingness at specified level of >=20% - excluding 0 sa… #>  #> ℹ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #> ✔ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #>  #> ℹ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #> ✔ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #>  #> ℹ Running sample data PCA outlier analysis at +/- 5 Sdev #> ✔ Running sample data PCA outlier analysis at +/- 5 Sdev [20ms] #>  #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #> ! The stated max PCs [max_num_pcs=10] to use in PCA outlier assessment is greater than the number of available informative PCs [7] #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier…✔ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #>  #> ℹ Creating final QC dataset... #> ✔ Creating final QC dataset... [113ms] #>  #> ℹ Metabolite QC Process Completed #> ✔ Metabolite QC Process Completed [23ms]"},{"path":"https://mrcieu.github.io/metaboprep/articles/nightingale.html","id":"quick-summary-of-the-metaboprep-object-following-qc","dir":"Articles","previous_headings":"","what":"Quick summary of the metaboprep object following QC","title":"Import Nightingale Metabolomic Data","text":"","code":"summary(mydata) #> Metaboprep Object Summary #> -------------------------- #> Samples      : 50 #> Features     : 15 #> Data Layers  : 2 #> Layer Names  : input, qc #>  #> Sample Summary Layers : input, qc #> Feature Summary Layers: input, qc #>  #> Sample Annotation (metadata): #>   Columns: 7 #>   Names  : sample_id, high_pyruvate, high_lactate, low_glutamine__high_glutamate, plasma_sample, reason_excluded, excluded #>  #> Feature Annotation (metadata): #>   Columns: 3 #>   Names  : feature_id, reason_excluded, excluded #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 0 #> user_defined_sample_missingness   | 0 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 0"},{"path":"https://mrcieu.github.io/metaboprep/articles/olink.html","id":"import-olink-data","dir":"Articles","previous_headings":"","what":"Import Olink data","title":"Import Olink Proteomic Data","text":"Read Olink data using read_olink function. read example data provided package, list object.","code":"library(metaboprep)  # example file olink_file <- system.file(\"extdata\", \"olink_v1_example.txt\", package=\"metaboprep\")  # import dat <- read_olink(olink_file,                    return_Metaboprep = FALSE )"},{"path":"https://mrcieu.github.io/metaboprep/articles/olink.html","id":"quick-look-to-identify-the-types-of-data-imported","dir":"Articles","previous_headings":"","what":"Quick look to identify the types of data imported","title":"Import Olink Proteomic Data","text":"Note advocate read olink data list object first, often additional information may wish inspect prior creating Metaboprep object.","code":"names(dat) #> [1] \"data\"             \"samples\"          \"features\"         \"controls\"         #> [5] \"control_metadata\""},{"path":"https://mrcieu.github.io/metaboprep/articles/olink.html","id":"create-metaboprep-object","dir":"Articles","previous_headings":"","what":"Create Metaboprep object","title":"Import Olink Proteomic Data","text":"imported, pass data Metaboprep() function build Metaboprep class object.","code":"mydata <- Metaboprep(data      = dat$data,                       features  = dat$features,                       samples   = dat$samples)"},{"path":"https://mrcieu.github.io/metaboprep/articles/olink.html","id":"quick-summary-of-the-metaboprep-object","dir":"Articles","previous_headings":"","what":"Quick summary of the metaboprep object","title":"Import Olink Proteomic Data","text":"","code":"summary(mydata) #> Metaboprep Object Summary #> -------------------------- #> Samples      : 90 #> Features     : 100 #> Data Layers  : 1 #> Layer Names  : input #>  #> Sample Summary Layers : none #> Feature Summary Layers: none #>  #> Sample Annotation (metadata): #>   Columns: 3 #>   Names  : sample_id, PlateID, QC_Warning #>  #> Feature Annotation (metadata): #>   Columns: 8 #>   Names  : feature_id, UniProt, Assay, MissingFreq, Panel, Panel_Version, LOD, Normalization #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 0 #> user_defined_sample_missingness   | 0 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 0"},{"path":"https://mrcieu.github.io/metaboprep/articles/olink.html","id":"qc-olink-data","dir":"Articles","previous_headings":"","what":"QC Olink data","title":"Import Olink Proteomic Data","text":"Perform QC steps using quality_control function.","code":"mydata <- mydata |>   quality_control(source_layer        = \"input\",                    sample_missingness  = 0.2,                    feature_missingness = 0.2,                    total_peak_area_sd  = 5,                    outlier_udist       = 5,                    outlier_treatment   = \"leave_be\",                    winsorize_quantile  = 1.0,                    tree_cut_height     = 0.5,                    pc_outlier_sd       = 5,                   feature_selection   = \"max_var_exp\",                   features_exclude_but_keep = NULL                   ) #>  #> ── Starting Metabolite QC Process ────────────────────────────────────────────── #> ℹ Validating input parameters #> ✔ Validating input parameters [13ms] #>  #> ℹ Sample & Feature Summary Statistics for raw data #> ✔ Sample & Feature Summary Statistics for raw data [1.1s] #>  #> ℹ Copying input data to new 'qc' data layer #> ✔ Copying input data to new 'qc' data layer [22ms] #>  #> ℹ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) #> ✔ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) [16ms] #>  #> ℹ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) #> ✔ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) [20m… #>  #> ℹ Assessing for sample missingness at specified level of >=20% - excluding 0 sa… #> ✔ Assessing for sample missingness at specified level of >=20% - excluding 0 sa… #>  #> ℹ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #> ✔ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #>  #> ℹ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #> ✔ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #>  #> ℹ Running sample data PCA outlier analysis at +/- 5 Sdev #> ✔ Running sample data PCA outlier analysis at +/- 5 Sdev [21ms] #>  #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #> ✔ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #>  #> ℹ Creating final QC dataset... #> ✔ Creating final QC dataset... [985ms] #>  #> ℹ Metabolite QC Process Completed #> ✔ Metabolite QC Process Completed [14ms] #>"},{"path":"https://mrcieu.github.io/metaboprep/articles/olink.html","id":"quick-summary-of-the-metaboprep-object-following-qc","dir":"Articles","previous_headings":"","what":"Quick summary of the metaboprep object following QC","title":"Import Olink Proteomic Data","text":"","code":"summary(mydata) #> Metaboprep Object Summary #> -------------------------- #> Samples      : 90 #> Features     : 100 #> Data Layers  : 2 #> Layer Names  : input, qc #>  #> Sample Summary Layers : input, qc #> Feature Summary Layers: input, qc #>  #> Sample Annotation (metadata): #>   Columns: 5 #>   Names  : sample_id, PlateID, QC_Warning, reason_excluded, excluded #>  #> Feature Annotation (metadata): #>   Columns: 10 #>   Names  : feature_id, UniProt, Assay, MissingFreq, Panel, Panel_Version, LOD, Normalization, reason_excluded, excluded #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 0 #> user_defined_sample_missingness   | 0 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 0"},{"path":"https://mrcieu.github.io/metaboprep/articles/quality_control.html","id":"run-the-quality-control-pipeline","dir":"Articles","previous_headings":"","what":"Run the quality control pipeline","title":"quality_control","text":"","code":"# run QC m <- quality_control(m,                       source_layer = \"input\",                       sample_missingness  = 0.2,                       feature_missingness = 0.2,                       total_peak_area_sd  = 5,                       outlier_udist       = 5,                       outlier_treatment   = \"leave_be\",                       winsorize_quantile  = 1.0,                       tree_cut_height     = 0.5,                       pc_outlier_sd       = 5,                       sample_ids          = NULL,                       feature_ids         = NULL) #>  #> ── Starting Metabolite QC Process ────────────────────────────────────────────── #> ℹ Validating input parameters #> ✔ Validating input parameters [8ms] #>  #> ℹ Sample & Feature Summary Statistics for raw data #> ✔ Sample & Feature Summary Statistics for raw data [896ms] #>  #> ℹ Copying input data to new 'qc' data layer #> ✔ Copying input data to new 'qc' data layer [36ms] #>  #> ℹ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) #> ✔ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) [18ms] #>  #> ℹ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) #> ✔ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) [18m… #>  #> ℹ Assessing for sample missingness at specified level of >=20% - excluding 0 sa… #> ✔ Assessing for sample missingness at specified level of >=20% - excluding 2 sa… #>  #> ℹ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #> ✔ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #>  #> ℹ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #> ✔ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #>  #> ℹ Running sample data PCA outlier analysis at +/- 5 Sdev #> ✔ Running sample data PCA outlier analysis at +/- 5 Sdev [17ms] #>  #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #> ! The stated max PCs [max_num_pcs=10] to use in PCA outlier assessment is greater than the number of available informative PCs [2] #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier…✔ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #>  #> ℹ Creating final QC dataset... #> ✔ Creating final QC dataset... [862ms] #>  #> ℹ Metabolite QC Process Completed #> ✔ Metabolite QC Process Completed [24ms]"},{"path":"https://mrcieu.github.io/metaboprep/articles/quality_control.html","id":"view-a-summary-of-the-metaboprep-object","dir":"Articles","previous_headings":"","what":"View a summary of the Metaboprep object","title":"quality_control","text":"","code":"# view summary summary(m) #> Metaboprep Object Summary #> -------------------------- #> Samples      : 100 #> Features     : 100 #> Data Layers  : 2 #> Layer Names  : input, qc #>  #> Sample Summary Layers : input, qc #> Feature Summary Layers: input, qc #>  #> Sample Annotation (metadata): #>   Columns: 8 #>   Names  : sample_id, neg, pos, run_day, box_id, lot, reason_excluded, excluded #>  #> Feature Annotation (metadata): #>   Columns: 9 #>   Names  : feature_id, metabolite_id, comp_id, platform, pathway, kegg, group_hmdb, reason_excluded, excluded #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 0 #> user_defined_sample_missingness   | 2 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 0"},{"path":"https://mrcieu.github.io/metaboprep/articles/sample_summary.html","id":"create-metaboprep-object","dir":"Articles","previous_headings":"","what":"Create Metaboprep object","title":"Sample summary","text":"","code":"library(metaboprep)  # import data data     <- read.csv(system.file(\"extdata\", \"dummy_data.csv\",     package = \"metaboprep\"), header=T, row.names = 1) |> as.matrix() samples  <- read.csv(system.file(\"extdata\", \"dummy_samples.csv\",  package = \"metaboprep\"), header=T, row.names = 1) features <- read.csv(system.file(\"extdata\", \"dummy_features.csv\", package = \"metaboprep\"), header=T, row.names = 1)  # create object mydata <- Metaboprep(data = data, samples = samples, features = features)"},{"path":"https://mrcieu.github.io/metaboprep/articles/sample_summary.html","id":"summary-of-metaboprep-object","dir":"Articles","previous_headings":"","what":"Summary of Metaboprep object","title":"Sample summary","text":"","code":"summary(mydata) #> Metaboprep Object Summary #> -------------------------- #> Samples      : 100 #> Features     : 20 #> Data Layers  : 1 #> Layer Names  : input #>  #> Sample Summary Layers : none #> Feature Summary Layers: none #>  #> Sample Annotation (metadata): #>   Columns: 5 #>   Names  : sample_id, age, sex, pos, neg #>  #> Feature Annotation (metadata): #>   Columns: 5 #>   Names  : feature_id, platform, pathway, derived_feature, xenobiotic_feature #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 0 #> user_defined_sample_missingness   | 0 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 0"},{"path":"https://mrcieu.github.io/metaboprep/articles/sample_summary.html","id":"run-sample-summary","dir":"Articles","previous_headings":"","what":"Run sample summary","title":"Sample summary","text":"","code":"# note that for illustrative purposes we are using a log outlier unit distance of 1.0 here, in practice we tend to favor a value of 5.0. sample_sum1 <- sample_summary(metaboprep      = mydata,                                source_layer    = \"input\",                                outlier_udist   = 1.0,                               output          = \"data.frame\")"},{"path":[]},{"path":"https://mrcieu.github.io/metaboprep/articles/sample_summary.html","id":"run-sample-summary-on-subset","dir":"Articles","previous_headings":"","what":"Run sample summary on subset","title":"Sample summary","text":"Using sample_ids feature_ids arguments can run summary subset data. Note: rows return, however summary data returned specified ids.","code":"## define a vector of sample IDs sids <- mydata@samples[mydata@samples$sex == \"female\", \"sample_id\"]   ## define a vector of feature IDs fids <- mydata@features[, \"feature_id\"] |> sample(10)  # run sample summary on subset sample_sum_subset <- sample_summary(metaboprep    = mydata,                                      source_layer  = \"input\",                                      outlier_udist = 1.0,                                     sample_ids    = sids,                                     feature_ids   = fids,                                     output        = \"data.frame\")"},{"path":[]},{"path":"https://mrcieu.github.io/metaboprep/articles/sample_summary.html","id":"run-pca-analysis","dir":"Articles","previous_headings":"","what":"Run PCA analysis","title":"Sample summary","text":"pc_and_outliers() performs principal component analysis. Missing data imputed median used identify number informative ‘significant’ PCs (1) acceleration analysis, (2) parallel analysis. Finally number sample outliers determined 3, 4, 5 standard deviations mean top PCs determined acceleration factor analysis.","code":"pc_analysis <- pc_and_outliers(metaboprep   = mydata,                                 source_layer = \"input\",                                sample_ids   = sids, ## It is also possible to run on a subset of samples and/or features                                feature_ids  = NULL                                )"},{"path":"https://mrcieu.github.io/metaboprep/articles/sample_summary.html","id":"table-of-pca-analysis-results","dir":"Articles","previous_headings":"","what":"Table of PCA analysis results","title":"Sample summary","text":"Returned PC eigenvectors top 10 PCs, outlier counts 3, 4, 5 standard deviations mean top two PCs","code":""},{"path":"https://mrcieu.github.io/metaboprep/articles/sample_summary.html","id":"additional-attributes","dir":"Articles","previous_headings":"","what":"Additional attributes","title":"Sample summary","text":"addition, variance explained vector appended returned data.frame attribute. can accessed attribute name: [source_layer]_varexp, case used input data, therefore attribute name input_varexp. similar way, results acceleration analysis (input_num_pcs_scree) parallel analysis (input_num_pcs_parallel) can also extracted.","code":"library(ggplot2)  # extract varexp from attributes varexp <- attr(pc_analysis, 'input_varexp')  # subset to top 100 for nicer plotting if (length(varexp) > 100) varexp <- varexp[1:100]  # get acceleration and parallel analysis results af <- attr(pc_analysis, 'input_num_pcs_scree') np <- attr(pc_analysis, 'input_num_pcs_parallel') if (af==np) np <- np+0.1 # make line visible if equal  # as data.frame x_labs <- sub(\"(?i)pc\",\"\", names(varexp)) ve     <- data.frame(\"pc\"      = factor(x_labs, levels=x_labs),                      \"var_exp\" = varexp) lines  <- data.frame(\"Analysis\" = c(\"Acceleration\", \"Parallel\"),                       \"pc\"       = c(af, np))     # plot ggplot(ve, aes(x = pc, y = var_exp)) +   geom_line(color = \"grey\") +   geom_point(shape = 21, fill = \"#377EB8\", size = 2) +   geom_vline(data = lines, aes(xintercept = pc, color = Analysis), inherit.aes = FALSE) +   scale_color_manual(values = c(\"Acceleration\"=\"#E41A1C\", \"Parallel\"=\"#4DAF4A\")) +   scale_x_discrete(labels = function(x) ifelse(seq_along(x) %% 10 == 0 | x==1, x, \"\")) +   labs(x = \"PC\", y = \"Variance explained\") +   theme_classic() +   theme(legend.position = \"top\")"},{"path":"https://mrcieu.github.io/metaboprep/articles/sample_summary.html","id":"run-sample-feature-summaries-together","dir":"Articles","previous_headings":"","what":"Run sample & feature summaries together","title":"Sample summary","text":"","code":"sf_sum <- summarise(metaboprep    = mydata,                      source_layer    = \"input\",                      outlier_udist   = 1.0,                     tree_cut_height = 0.5,                     sample_ids      = sids, ## It is also possible to run on a subset of samples and/or features                     feature_ids     = NULL,                     output          = \"data.frame\")  ## two data frames are returned as a list object names(sf_sum) #> [1] \"sample_summary\"  \"feature_summary\""},{"path":"https://mrcieu.github.io/metaboprep/articles/sample_summary.html","id":"table-of-sample-summary-on-subset-1","dir":"Articles","previous_headings":"","what":"Table of sample summary on subset","title":"Sample summary","text":"Note summarise() function used sample summary now includes PCA derived summary data. case sample_summary() function run alone, seen . reason difference PCA data dependent upon feature_summary() analysis. Also, please note running subset, returned full summary samples features, summary data specified subset populated, rest NA.","code":""},{"path":"https://mrcieu.github.io/metaboprep/articles/somalogic.html","id":"import-somalogic-data","dir":"Articles","previous_headings":"","what":"Import SomaLogic data","title":"Import Somalogic Proteomic Data","text":"Read SomaLogic data using read_somalogic function. read example data provided package, list object.","code":"library(metaboprep)  # example file filepath <- system.file(\"extdata\", \"somalogic_v1_example.adat\", package = \"metaboprep\")  # import dat <- read_somalogic(filepath,                       return_Metaboprep = FALSE)  # create the object (down-sampled for speed) m <- Metaboprep(data     = dat$data[1:9, 1:100],                  samples  = dat$samples[1:9, ],                  features = dat$features[1:100, ],                 )"},{"path":"https://mrcieu.github.io/metaboprep/articles/somalogic.html","id":"quick-look-to-identify-the-types-of-data-imported","dir":"Articles","previous_headings":"","what":"Quick look to identify the types of data imported","title":"Import Somalogic Proteomic Data","text":"Note advocate read olink data list object first, often additional information may wish inspect prior creating Metaboprep object.","code":"names(dat) #> [1] \"data\"             \"samples\"          \"features\"         \"controls\"         #> [5] \"control_metadata\""},{"path":"https://mrcieu.github.io/metaboprep/articles/somalogic.html","id":"create-metaboprep-object","dir":"Articles","previous_headings":"","what":"Create Metaboprep object","title":"Import Somalogic Proteomic Data","text":"imported, pass data Metaboprep() function build Metaboprep class object.","code":"mydata <- Metaboprep(data     = dat$data[1:9, 1:100],                       samples  = dat$samples[1:9, ],                       features = dat$features[1:100, ]                      )"},{"path":"https://mrcieu.github.io/metaboprep/articles/somalogic.html","id":"quick-summary-of-the-metaboprep-object","dir":"Articles","previous_headings":"","what":"Quick summary of the metaboprep object","title":"Import Somalogic Proteomic Data","text":"","code":"summary(mydata) #> Metaboprep Object Summary #> -------------------------- #> Samples      : 9 #> Features     : 100 #> Data Layers  : 1 #> Layer Names  : input #>  #> Sample Summary Layers : none #> Feature Summary Layers: none #>  #> Sample Annotation (metadata): #>   Columns: 34 #>   Names  : sample_id, PlateId, PlateRunDate, ScannerID, PlatePosition, SlideId, Subarray, SampleType, PercentDilution, SampleMatrix, Barcode, Barcode2d, SampleName, SampleNotes, AliquotingNotes, SampleDescription, AssayNotes, TimePoint, ExtIdentifier, SsfExtId, SampleGroup, SiteId, TubeUniqueID, CLI, HybControlNormScale, RowCheck, NormScale_20, NormScale_0_005, NormScale_0_5, ANMLFractionUsed_20, ANMLFractionUsed_0_005, ANMLFractionUsed_0_5, Age, Sex #>  #> Feature Annotation (metadata): #>   Columns: 22 #>   Names  : feature_id, SeqId, SeqIdVersion, SomaId, TargetFullName, Target, UniProt, EntrezGeneID, EntrezGeneSymbol, Organism, Units, Type, Dilution, PlateScale_Reference, CalReference, Cal_Example_Adat_Set001, ColCheck, CalQcRatio_Example_Adat_Set001_170255, QcReference_170255, Cal_Example_Adat_Set002, CalQcRatio_Example_Adat_Set002_170255, Dilution2 #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 0 #> user_defined_sample_missingness   | 0 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 0"},{"path":"https://mrcieu.github.io/metaboprep/articles/somalogic.html","id":"qc-olink-data","dir":"Articles","previous_headings":"","what":"QC Olink data","title":"Import Somalogic Proteomic Data","text":"Perform QC steps using quality_control function.","code":"mydata <- mydata |>   quality_control(source_layer        = \"input\",                    sample_missingness  = 0.2,                    feature_missingness = 0.2,                    total_peak_area_sd  = 5,                    outlier_udist       = 5,                    outlier_treatment   = \"leave_be\",                    winsorize_quantile  = 1.0,                    tree_cut_height     = 0.5,                    pc_outlier_sd       = 5,                   feature_selection   = \"max_var_exp\",                   features_exclude_but_keep = NULL                   ) #>  #> ── Starting Metabolite QC Process ────────────────────────────────────────────── #> ℹ Validating input parameters #> ✔ Validating input parameters [10ms] #>  #> ℹ Sample & Feature Summary Statistics for raw data #> ✔ Sample & Feature Summary Statistics for raw data [457ms] #>  #> ℹ Copying input data to new 'qc' data layer #> ✔ Copying input data to new 'qc' data layer [30ms] #>  #> ℹ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) #> ✔ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) [15ms] #>  #> ℹ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) #> ✔ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) [16m… #>  #> ℹ Assessing for sample missingness at specified level of >=20% - excluding 0 sa… #> ✔ Assessing for sample missingness at specified level of >=20% - excluding 0 sa… #>  #> ℹ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #> ✔ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #>  #> ℹ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #> ✔ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #>  #> ℹ Running sample data PCA outlier analysis at +/- 5 Sdev #> ✔ Running sample data PCA outlier analysis at +/- 5 Sdev [18ms] #>  #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #> ! The stated max PCs [max_num_pcs=10] to use in PCA outlier assessment is greater than the number of available informative PCs [2] #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier…✔ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #>  #> ℹ Creating final QC dataset... #> ✔ Creating final QC dataset... [401ms] #>  #> ℹ Metabolite QC Process Completed #> ✔ Metabolite QC Process Completed [14ms]"},{"path":"https://mrcieu.github.io/metaboprep/articles/somalogic.html","id":"quick-summary-of-the-metaboprep-object-following-qc","dir":"Articles","previous_headings":"","what":"Quick summary of the metaboprep object following QC","title":"Import Somalogic Proteomic Data","text":"","code":"summary(mydata) #> Metaboprep Object Summary #> -------------------------- #> Samples      : 9 #> Features     : 100 #> Data Layers  : 2 #> Layer Names  : input, qc #>  #> Sample Summary Layers : input, qc #> Feature Summary Layers: input, qc #>  #> Sample Annotation (metadata): #>   Columns: 36 #>   Names  : sample_id, PlateId, PlateRunDate, ScannerID, PlatePosition, SlideId, Subarray, SampleType, PercentDilution, SampleMatrix, Barcode, Barcode2d, SampleName, SampleNotes, AliquotingNotes, SampleDescription, AssayNotes, TimePoint, ExtIdentifier, SsfExtId, SampleGroup, SiteId, TubeUniqueID, CLI, HybControlNormScale, RowCheck, NormScale_20, NormScale_0_005, NormScale_0_5, ANMLFractionUsed_20, ANMLFractionUsed_0_005, ANMLFractionUsed_0_5, Age, Sex, reason_excluded, excluded #>  #> Feature Annotation (metadata): #>   Columns: 24 #>   Names  : feature_id, SeqId, SeqIdVersion, SomaId, TargetFullName, Target, UniProt, EntrezGeneID, EntrezGeneSymbol, Organism, Units, Type, Dilution, PlateScale_Reference, CalReference, Cal_Example_Adat_Set001, ColCheck, CalQcRatio_Example_Adat_Set001_170255, QcReference_170255, Cal_Example_Adat_Set002, CalQcRatio_Example_Adat_Set002_170255, Dilution2, reason_excluded, excluded #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 0 #> user_defined_sample_missingness   | 0 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 0"},{"path":"https://mrcieu.github.io/metaboprep/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Laura Corbin. Author. David Hughes. Author, maintainer. Nicholas Sunderland. Author. Matthew Lee. Author. Alec McKinlay. Author.","code":""},{"path":"https://mrcieu.github.io/metaboprep/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Corbin L, Hughes D, Sunderland N, Lee M, McKinlay (2025). metaboprep: Metabolomics data preparation processing pipeline. R package version 1.0.1, https://mrcieu.github.io/metaboprep/.","code":"@Manual{,   title = {metaboprep: Metabolomics data preparation and processing pipeline},   author = {Laura Corbin and David Hughes and Nicholas Sunderland and Matthew Lee and Alec McKinlay},   year = {2025},   note = {R package version 1.0.1},   url = {https://mrcieu.github.io/metaboprep/}, }"},{"path":"https://mrcieu.github.io/metaboprep/index.html","id":"metaboprep","dir":"","previous_headings":"","what":"Metabolomics data preparation and processing pipeline","title":"Metabolomics data preparation and processing pipeline","text":"goal metaboprep : Read processes (un)targeted metabolite data, saving datasets tab-delimited format use elsewhere Provide useful summary data form tab-delimited text file html report. Perform data filtering data set using standard pipeline according user-defined thresholds.","code":""},{"path":"https://mrcieu.github.io/metaboprep/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Metabolomics data preparation and processing pipeline","text":"can install development version metaboprep GitHub :","code":"# install.packages(\"pak\") pak::pak(\"MRCIEU/metaboprep\")"},{"path":"https://mrcieu.github.io/metaboprep/index.html","id":"cheatsheet","dir":"","previous_headings":"","what":"Cheatsheet","title":"Metabolomics data preparation and processing pipeline","text":"Cheatsheet","code":""},{"path":"https://mrcieu.github.io/metaboprep/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Metabolomics data preparation and processing pipeline","text":"basic example shows load data run metaboprep quality control pipeline.","code":""},{"path":"https://mrcieu.github.io/metaboprep/index.html","id":"read-data-into-r-and-create-the-metaboprep-object","dir":"","previous_headings":"Example","what":"Read data into R and create the Metaboprep object","title":"Metabolomics data preparation and processing pipeline","text":"","code":"library(metaboprep)  # import data  mydata <- read_metabolon(system.file(\"extdata\", \"metabolon_v1.1_example.xlsx\", package = \"metaboprep\"),                           sheet             = \"OrigScale\", ## The name of the sheet in the excel file to read in                          return_Metaboprep = FALSE        ## Whether to return a Metaboprep object (TRUE) or a list (FALSE)                          )  # create metaboprep object mydata <- Metaboprep(data     = mydata$data,                       features = mydata$features,                       samples  = mydata$samples)"},{"path":"https://mrcieu.github.io/metaboprep/index.html","id":"run-the-quality-control-pipeline","dir":"","previous_headings":"Example","what":"Run the quality control pipeline","title":"Metabolomics data preparation and processing pipeline","text":"","code":"# run QC mydata <- mydata |> quality_control( source_layer        = \"input\",                                       sample_missingness  = 0.2,                                       feature_missingness = 0.2,                                       total_peak_area_sd  = 5,                                       outlier_udist       = 5,                                       outlier_treatment   = \"leave_be\",                                       winsorize_quantile  = 1.0,                                       tree_cut_height     = 0.5,                                       pc_outlier_sd       = 5,                                       sample_ids          = NULL,                                       feature_ids         = NULL) #>  #> ── Starting Metabolite QC Process ────────────────────────────────────────────── #> ℹ Validating input parameters✔ Validating input parameters [4ms] #> ℹ Sample & Feature Summary Statistics for raw data✔ Sample & Feature Summary Statistics for raw data [540ms] #> ℹ Copying input data to new 'qc' data layer✔ Copying input data to new 'qc' data layer [10ms] #> ℹ Assessing for extreme sample missingness >=80% - excluding 0 sample(s)✔ Assessing for extreme sample missingness >=80% - excluding 0 sample(s) [7ms] #> ℹ Assessing for extreme feature missingness >=80% - excluding 0 feature(s)✔ Assessing for extreme feature missingness >=80% - excluding 0 feature(s) [7ms] #> ℹ Assessing for sample missingness at specified level of >=20% - excluding 0 sa…✔ Assessing for sample missingness at specified level of >=20% - excluding 2 sa… #> ℹ Assessing for feature missingness at specified level of >=20% - excluding 0 f…✔ Assessing for feature missingness at specified level of >=20% - excluding 0 f… #> ℹ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(…✔ Calculating total peak abundance outliers at +/- 5 Sdev - excluding 0 sample(… #> ℹ Running sample data PCA outlier analysis at +/- 5 Sdev✔ Running sample data PCA outlier analysis at +/- 5 Sdev [8ms] #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier…ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier…                                                                                 ! The stated max PCs [max_num_pcs=10] to use in PCA outlier assessment is greater than the number of available informative PCs [2] #> ℹ Sample PCA outlier analysis - re-identify feature independence and PC outlier…✔ Sample PCA outlier analysis - re-identify feature independence and PC outlier… #> ℹ Creating final QC dataset...✔ Creating final QC dataset... [409ms] #> ℹ Metabolite QC Process Completed✔ Metabolite QC Process Completed [9ms]"},{"path":"https://mrcieu.github.io/metaboprep/index.html","id":"view-a-summary-of-the-metaboprep-object","dir":"","previous_headings":"Example","what":"View a summary of the Metaboprep object","title":"Metabolomics data preparation and processing pipeline","text":"","code":"# view summary summary(mydata) #>  #> Metaboprep Object Summary #> -------------------------- #> Samples      : 100 #> Features     : 100 #> Data Layers  : 2 #> Layer Names  : input, qc #>  #> Sample Summary Layers : input, qc #> Feature Summary Layers: input, qc #>  #> Sample Annotation (metadata): #>   Columns: 8 #>   Names  : sample_id, neg, pos, run_day, box_id, lot, reason_excluded, excluded #>  #> Feature Annotation (metadata): #>   Columns: 8 #>   Names  : feature_id, metabolite_id, platform, pathway, kegg, group_hmdb, reason_excluded, excluded #>  #> Exclusion Codes Summary: #>  #>   Sample Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                     | 0 #> extreme_sample_missingness        | 0 #> user_defined_sample_missingness   | 2 #> user_defined_sample_totalpeakarea | 0 #> user_defined_sample_pca_outlier   | 0 #>  #>   Feature Exclusions: #> Exclusion | Count #> ----------------- #> user_excluded                    | 0 #> extreme_feature_missingness      | 0 #> user_defined_feature_missingness | 0"},{"path":"https://mrcieu.github.io/metaboprep/index.html","id":"plot-a-dendrogram-of-the-feature-tree","dir":"","previous_headings":"Example","what":"Plot a dendrogram of the feature tree","title":"Metabolomics data preparation and processing pipeline","text":"","code":"# view feature tree tree <- attr(mydata@feature_summary, \"qc_tree\") par(mar = c(1,3,5,1) ) plot(tree, hang = -1, cex = 0.75, main = \"Example Dataset Feature Tree\", sub = \"\", xlab = \"\")"},{"path":"https://mrcieu.github.io/metaboprep/reference/add_layer.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a Layer of Data (internal use) — add_layer","title":"Add a Layer of Data (internal use) — add_layer","text":"function adds additional layer data along third dimension existing 3D array (2D matrix/vector) stacking new layer data. ensures dimensions new layer match first two dimensions existing array matrix. mismatch row column names `force` parameter set `TRUE`, function align data filling missing values `NA`. used internally intended routine user use.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/add_layer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a Layer of Data (internal use) — add_layer","text":"","code":"add_layer(current, layer, layer_name, force = FALSE)"},{"path":"https://mrcieu.github.io/metaboprep/reference/add_layer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a Layer of Data (internal use) — add_layer","text":"current vector, matrix, 3D array representing current stack data. layer matrix array represents new layer data added. match dimensions first two dimensions `current`. layer_name character string specifying name new dimension 3rd axis. can used annotate new data layer. force logical value indicating whether force join create `NA` values row column names match `current` `layer`. Default `FALSE`.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/add_layer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add a Layer of Data (internal use) — add_layer","text":"3D array added layer third dimension.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/available_data_formats.html","id":null,"dir":"Reference","previous_headings":"","what":"List Available Data Formats — available_data_formats","title":"List Available Data Formats — available_data_formats","text":"Scans package source files functions starting \"read_\" determine supported data formats.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/available_data_formats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List Available Data Formats — available_data_formats","text":"","code":"available_data_formats()"},{"path":"https://mrcieu.github.io/metaboprep/reference/available_data_formats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List Available Data Formats — available_data_formats","text":"named character vector available data formats.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/available_report_templates.html","id":null,"dir":"Reference","previous_headings":"","what":"List Available Report Templates — available_report_templates","title":"List Available Report Templates — available_report_templates","text":"Scans package source files available report templates write .","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/available_report_templates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List Available Report Templates — available_report_templates","text":"","code":"available_report_templates()"},{"path":"https://mrcieu.github.io/metaboprep/reference/available_report_templates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List Available Report Templates — available_report_templates","text":"character vector available report templates","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/batch_normalise.html","id":null,"dir":"Reference","previous_headings":"","what":"Batch Normalisation — batch_normalise","title":"Batch Normalisation — batch_normalise","text":"Run batch normalisation based platform flag features data","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/batch_normalise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Batch Normalisation — batch_normalise","text":"","code":"batch_normalise(   metaboprep,   run_mode_col,   run_mode_colmap,   source_layer = \"input\",   dest_layer = \"batch_normalised\" )"},{"path":"https://mrcieu.github.io/metaboprep/reference/batch_normalise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Batch Normalisation — batch_normalise","text":"metaboprep object class Metaboprep run_mode_col character, column name features data containing run mode run_mode_colmap named character vector list, c(mode = \"mode col name samples\") source_layer character, data layer get data dest_layer character, data layer put data ","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/class_metaboprep.html","id":null,"dir":"Reference","previous_headings":"","what":"Metaboprep Object — class_metaboprep","title":"Metaboprep Object — class_metaboprep","text":"`Metaboprep` object container matrices metabolite data, along associated metadata. allows efficient storage manipulation data, supporting quality control, transformations, various analyses. object facilitates easy access data layers, sample feature summaries, outlier treatment, .","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/class_metaboprep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Metaboprep Object — class_metaboprep","text":"","code":"Metaboprep(   data,   samples,   features,   exclusions = list(samples = list(user_excluded = character(),     extreme_sample_missingness = character(), user_defined_sample_missingness =     character(), user_defined_sample_totalpeakarea = character(),     user_defined_sample_pca_outlier = character()), features = list(user_excluded =     character(), extreme_feature_missingness = character(),     user_defined_feature_missingness = character())),   feature_summary = array(data = NA_real_, dim = c(0, 0, 0)),   sample_summary = array(data = NA_real_, dim = c(0, 0, 0)) )"},{"path":"https://mrcieu.github.io/metaboprep/reference/class_metaboprep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Metaboprep Object — class_metaboprep","text":"data numeric matrix, data matrix containing metabolite values (set directly). samples data.frame, data frame containing sample-related information (set directly). features data.frame, data frame containing feature-related information (set directly). exclusions list, holds exclusion codes data masking (set directly). feature_summary numeric matrix, summary statistics features (set directly). sample_summary numeric matrix, summary statistics samples (set directly).","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/class_metaboprep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Metaboprep Object — class_metaboprep","text":"object class Metaboprep, S7 class.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/class_metaboprep.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Metaboprep Object — class_metaboprep","text":"data numeric matrix, metabolite data. samples data.frame, samples data frame features data.frame, features data frame exclusions list, exclusion codes (mask data). feature_summary numeric matrix, feature summary statistics. sample_summary numeric matrix, sample summary statistics.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/clean_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Standardize Column or Feature Names — clean_names","title":"Standardize Column or Feature Names — clean_names","text":"Cleans character vector names replacing spaces underscores, removing special characters (`-`, `.`), replacing ` converting lowercase.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/clean_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Standardize Column or Feature Names — clean_names","text":"","code":"clean_names(names)"},{"path":"https://mrcieu.github.io/metaboprep/reference/clean_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Standardize Column or Feature Names — clean_names","text":"names `character vector` vector names cleaned.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/clean_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Standardize Column or Feature Names — clean_names","text":"`character vector` standardized version input names.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/clean_names.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Standardize Column or Feature Names — clean_names","text":"","code":"clean_names(c(\"Sample ID\", \"Feature-Name.1\", \"Concentration %\")) #> [1] \"sample_id\"         \"featurename_1\"     \"concentration_pct\" # Returns: c(\"sample_id\", \"featurename1\", \"concentration_pct\")"},{"path":"https://mrcieu.github.io/metaboprep/reference/continuous_power_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"continuous trait power analysis plot — continuous_power_plot","title":"continuous trait power analysis plot — continuous_power_plot","text":"function (1) identifies informative distribution effect power estimates given datas total sample size (2) returns summary plot.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/continuous_power_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"continuous trait power analysis plot — continuous_power_plot","text":"","code":"continuous_power_plot(mydata)"},{"path":"https://mrcieu.github.io/metaboprep/reference/continuous_power_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"continuous trait power analysis plot — continuous_power_plot","text":"mydata metabolite data matrix, samples rows","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/continuous_power_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"continuous trait power analysis plot — continuous_power_plot","text":"ggplot2 object","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/continuous_power_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"continuous trait power analysis plot — continuous_power_plot","text":"","code":"ex_data = matrix(NA, 1000, 2) continuous_power_plot( ex_data ) #> Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. #> ℹ Please use `linewidth` instead. #> ℹ The deprecated feature was likely used in the metaboprep package. #>   Please report the issue to the authors."},{"path":"https://mrcieu.github.io/metaboprep/reference/cramerV.html","id":null,"dir":"Reference","previous_headings":"","what":"Cramer's V (phi) — cramerV","title":"Cramer's V (phi) — cramerV","text":"Calculates Cramer's V table nominal variables;              confidence intervals bootstrap. Function taken rcompanion Rpackage.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/cramerV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cramer's V (phi) — cramerV","text":"","code":"cramerV(   x,   y = NULL,   ci = FALSE,   conf = 0.95,   type = \"perc\",   R = 1000,   digits = 4,   bias.correct = FALSE,   reportIncomplete = FALSE,   verbose = FALSE,   ... )"},{"path":"https://mrcieu.github.io/metaboprep/reference/cramerV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cramer's V (phi) — cramerV","text":"x Either two-way table two-way matrix. Can also vector observations one dimension two-way table. y x vector, y vector observations second dimension two-way table. ci TRUE, returns confidence intervals bootstrap. May slow. conf level confidence interval. type type confidence interval use. Can \"norm\", \"basic\",               \"perc\", \"bca\". Passed boot.ci. R number replications use bootstrap. digits number significant digits output. bias.correct TRUE, bias correction applied. reportIncomplete FALSE (default), NA reported cases instances calculation statistic failing bootstrap procedure. verbose TRUE, prints additional statistics. ... Additional arguments passed chisq.test.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/cramerV.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cramer's V (phi) — cramerV","text":"single statistic, Cramer's V.         small data frame consisting Cramer's V,         lower upper confidence limits.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/cramerV.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cramer's V (phi) — cramerV","text":"Cramer's V used measure association           two nominal variables, effect size           chi-square test association.  2 x 2 table,           absolute value phi statistic           Cramer's V. V always positive, type=\"perc\",           confidence interval           never cross zero. case,           confidence interval range           used statistical inference.           However, type=\"norm\", confidence interval           may cross zero. V close 0 large,           small counts,           confidence intervals           determined           method may reliable, procedure may fail.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/cramerV.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cramer's V (phi) — cramerV","text":"http://rcompanion.org/handbook/H_10.html","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/cramerV.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Cramer's V (phi) — cramerV","text":"Salvatore Mangiafico, mangiafico@njaes.rutgers.edu","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/eval.power.binary.imbalanced.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate power for a binary variable in an imbalanced design — eval.power.binary.imbalanced","title":"Estimate power for a binary variable in an imbalanced design — eval.power.binary.imbalanced","text":"function allows estimate power binary variable given defined number case samples, control samples, effect size, significance threshold.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/eval.power.binary.imbalanced.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate power for a binary variable in an imbalanced design — eval.power.binary.imbalanced","text":"","code":"eval.power.binary.imbalanced(N_case, N_control, effect, alpha)"},{"path":"https://mrcieu.github.io/metaboprep/reference/eval.power.binary.imbalanced.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate power for a binary variable in an imbalanced design — eval.power.binary.imbalanced","text":"N_case numeric vector sample size cases N_control numeric vector sample size controls effect numeric vector effect size alpha numeric vector significance thresholds","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/eval.power.binary.imbalanced.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate power for a binary variable in an imbalanced design — eval.power.binary.imbalanced","text":"matrix paramater inputs power estimates returned matrix","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/eval.power.binary.imbalanced.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate power for a binary variable in an imbalanced design — eval.power.binary.imbalanced","text":"","code":"eval.power.binary.imbalanced( N_case = 1000,  N_control = 1000,  effect = 0.01,  alpha = 0.05 ) #>         N N_case N_control effect alpha power #> [1,] 2000   1000      1000   0.01  0.05 0.056  eval.power.binary.imbalanced( N_case = c(1000, 2000),  N_control = c(1000, 2000),  effect = 0.01,  alpha = 0.05 ) #>         N N_case N_control effect alpha power #> [1,] 2000   1000      1000   0.01  0.05 0.056 #> [2,] 4000   2000      2000   0.01  0.05 0.062"},{"path":"https://mrcieu.github.io/metaboprep/reference/eval.power.cont.html","id":null,"dir":"Reference","previous_headings":"","what":"estimate power for continuous variable — eval.power.cont","title":"estimate power for continuous variable — eval.power.cont","text":"function estimates power continuous variable given sample size, effect size, significance threshold, degrees freedom.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/eval.power.cont.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"estimate power for continuous variable — eval.power.cont","text":"","code":"eval.power.cont(N, n_coeff, effect, alpha)"},{"path":"https://mrcieu.github.io/metaboprep/reference/eval.power.cont.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"estimate power for continuous variable — eval.power.cont","text":"N Sample size n_coeff degrees freedom numerator effect effect size alpha significance level (Type 1 error)","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/eval.power.cont.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"estimate power for continuous variable — eval.power.cont","text":"","code":"eval.power.cont(N = 1000, n_coeff = 1, effect = 0.0025, alpha = 0.05) #>         N effect alpha power n_coeff #> [1,] 1000 0.0025  0.05 0.352       1"},{"path":"https://mrcieu.github.io/metaboprep/reference/export.html","id":null,"dir":"Reference","previous_headings":"","what":"Export Data from a Metaboprep Object — export","title":"Export Data from a Metaboprep Object — export","text":"Exports data `Metaboprep` object structured directory format. data layer, function creates subdirectory containing: - primary data matrix (`data.tsv`), - associated feature sample metadata (`features.tsv`, `samples.tsv`), - feature sample summaries (present, `feature_summary.tsv`, `sample_summary.tsv`), - serialized feature tree (present), - `config.yml` file additional metadata processing parameters.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/export.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export Data from a Metaboprep Object — export","text":"","code":"export(metaboprep, directory, format = \"metaboprep\", ...)"},{"path":"https://mrcieu.github.io/metaboprep/reference/export.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export Data from a Metaboprep Object — export","text":"metaboprep `Metaboprep` object containing data exported. directory character, string specifying path directory data written. format character, string specifying format exported data - one \"metaboprep\", \"comets\", \"metaboanalyst\". ... Arguments passed export_comets, export_metaboanalyst layer character, name `metaboprep@data` layer (3rd array dimension) write group_col character, column name `metaboprep@samples` data identifying group one-factor analysis","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/export.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export Data from a Metaboprep Object — export","text":"`Metaboprep` object, invisibly, use pipes","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/export_comets.html","id":null,"dir":"Reference","previous_headings":"","what":"Export Data to `COMETS` format — export_comets","title":"Export Data to `COMETS` format — export_comets","text":"Export Data `COMETS` format","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/export_comets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export Data to `COMETS` format — export_comets","text":"","code":"export_comets(metaboprep, directory, layer = NULL)"},{"path":"https://mrcieu.github.io/metaboprep/reference/export_comets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export Data to `COMETS` format — export_comets","text":"metaboprep `Metaboprep` object containing data exported. directory character, string specifying path directory data written. layer character, name `metaboprep@data` layer (3rd array dimension) write ","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/export_comets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export Data to `COMETS` format — export_comets","text":"`Metaboprep` object, invisibly, use pipes","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/export_metaboanalyst.html","id":null,"dir":"Reference","previous_headings":"","what":"Export Data to `MetaboAnalyst` format — export_metaboanalyst","title":"Export Data to `MetaboAnalyst` format — export_metaboanalyst","text":"Export Data `MetaboAnalyst` format","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/export_metaboanalyst.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export Data to `MetaboAnalyst` format — export_metaboanalyst","text":"","code":"export_metaboanalyst(metaboprep, directory, layer = NULL, group_col = NULL)"},{"path":"https://mrcieu.github.io/metaboprep/reference/export_metaboanalyst.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export Data to `MetaboAnalyst` format — export_metaboanalyst","text":"metaboprep `Metaboprep` object containing data exported. directory character, string specifying path directory data written. layer character, name `metaboprep@data` layer (3rd array dimension) write group_col character, column name `metaboprep@samples` data identifying group one-factor analysis","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/export_metaboanalyst.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export Data to `MetaboAnalyst` format — export_metaboanalyst","text":"`Metaboprep` object, invisibly, use pipes","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/export_metaboprep.html","id":null,"dir":"Reference","previous_headings":"","what":"Export Data to `Metaboprep` format — export_metaboprep","title":"Export Data to `Metaboprep` format — export_metaboprep","text":"Export Data `Metaboprep` format","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/export_metaboprep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export Data to `Metaboprep` format — export_metaboprep","text":"","code":"export_metaboprep(metaboprep, directory, ...)"},{"path":"https://mrcieu.github.io/metaboprep/reference/export_metaboprep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export Data to `Metaboprep` format — export_metaboprep","text":"metaboprep `Metaboprep` object containing data exported. directory character, string specifying path directory data written. ... parameters passed export_metaboprep(), export_comets(), export_metaboanalyst().","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/export_metaboprep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export Data to `Metaboprep` format — export_metaboprep","text":"`Metaboprep` object, invisibly, use pipes","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/feature_describe.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary Statistics for Features — feature_describe","title":"Summary Statistics for Features — feature_describe","text":"function allows 'describe' metabolite features using describe() function psych package, well estimate variance, dispersion index, coeficent variation, shapiro's W-statistic.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/feature_describe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary Statistics for Features — feature_describe","text":"","code":"feature_describe(data)"},{"path":"https://mrcieu.github.io/metaboprep/reference/feature_describe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary Statistics for Features — feature_describe","text":"data matrix, metabolite data matrix. Samples row, metabolites columns","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/feature_describe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary Statistics for Features — feature_describe","text":"data frame summary statistics features (columns) matrix","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/feature_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Feature Summary Statistics — feature_summary","title":"Feature Summary Statistics — feature_summary","text":"function estimates feature statistics samples matrix metabolite features.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/feature_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Feature Summary Statistics — feature_summary","text":"","code":"feature_summary(   metaboprep,   source_layer = \"input\",   outlier_udist = 5,   tree_cut_height = 0.5,   feature_selection = \"max_var_exp\",   sample_ids = NULL,   feature_ids = NULL,   features_exclude = NULL,   output = \"data.frame\" )"},{"path":"https://mrcieu.github.io/metaboprep/reference/feature_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Feature Summary Statistics — feature_summary","text":"metaboprep object class Metabolites source_layer character, data layer summarise outlier_udist unit distance SD IQR mean median estimate, respectively outliers identified . Default value 5. tree_cut_height numeric, threshold feature independence hierarchical clustering. Default 0.5. feature_selection character, either 'max_var_exp' 'least_missingness', select independent feature within clusters sample_ids character, vector sample ids work feature_ids character, vector feature ids work features_exclude character, vector feature id indicating features exclude sample PCA summary analysis keep data output character, type output, either 'object' return updated metaboprep object, 'data.frame' return data.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/find.PA.effect.sizes.2.sim.html","id":null,"dir":"Reference","previous_headings":"","what":"identify effect sizes — find.PA.effect.sizes.2.sim","title":"identify effect sizes — find.PA.effect.sizes.2.sim","text":"function estimates appropriate distribution effect sizes simulate power analysis.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/find.PA.effect.sizes.2.sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"identify effect sizes — find.PA.effect.sizes.2.sim","text":"","code":"find.PA.effect.sizes.2.sim(mydata)"},{"path":"https://mrcieu.github.io/metaboprep/reference/find.PA.effect.sizes.2.sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"identify effect sizes — find.PA.effect.sizes.2.sim","text":"mydata metabolite data matrix, samples rows","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/find.PA.effect.sizes.2.sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"identify effect sizes — find.PA.effect.sizes.2.sim","text":"vector effect sizes","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/find.PA.effect.sizes.2.sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"identify effect sizes — find.PA.effect.sizes.2.sim","text":"","code":"ex_data = sapply(1:10, function(x){ rnorm(250, 40, 5) }) find.PA.effect.sizes.2.sim(ex_data) #>  [1] 0.1401 0.1883 0.2365 0.2846 0.3328 0.3810 0.4292 0.4774 0.5255 0.5737 #> [11] 0.6219"},{"path":"https://mrcieu.github.io/metaboprep/reference/find.cont.effect.sizes.2.sim.html","id":null,"dir":"Reference","previous_headings":"","what":"identify continuos trait effect sizes — find.cont.effect.sizes.2.sim","title":"identify continuos trait effect sizes — find.cont.effect.sizes.2.sim","text":"function estimates appropriate distribution effect sizes simulate continuous trait power analysis.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/find.cont.effect.sizes.2.sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"identify continuos trait effect sizes — find.cont.effect.sizes.2.sim","text":"","code":"find.cont.effect.sizes.2.sim(mydata)"},{"path":"https://mrcieu.github.io/metaboprep/reference/find.cont.effect.sizes.2.sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"identify continuos trait effect sizes — find.cont.effect.sizes.2.sim","text":"mydata metabolite data matrix, samples rows","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/find.cont.effect.sizes.2.sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"identify continuos trait effect sizes — find.cont.effect.sizes.2.sim","text":"vector effect sizes","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/find.cont.effect.sizes.2.sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"identify continuos trait effect sizes — find.cont.effect.sizes.2.sim","text":"","code":"ex_data = sapply(1:10, function(x){ rnorm(250, 40, 5) }) find.cont.effect.sizes.2.sim(ex_data) #>  [1] 0.005001 0.014651 0.024301 0.033951 0.043601 0.053251 0.062901 0.072551 #>  [9] 0.082201 0.091851 0.101501"},{"path":"https://mrcieu.github.io/metaboprep/reference/generate_report.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Output Report — generate_report","title":"Generate Output Report — generate_report","text":"function writes output report","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/generate_report.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Output Report — generate_report","text":"","code":"generate_report(   metaboprep,   output_dir,   output_filename = NULL,   project = \"Project\",   format = \"pdf\",   template = \"qc_report\" )"},{"path":"https://mrcieu.github.io/metaboprep/reference/generate_report.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Output Report — generate_report","text":"metaboprep object class Metaboprep output_dir character, directory save output_filename character, default NULL .e. create input object project character, name current project format character, write either 'html' 'pdf' report template character, type report output current option \"qc_report\"","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/imbalanced_power_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"binary trait imbalanced design power analysis plot — imbalanced_power_plot","title":"binary trait imbalanced design power analysis plot — imbalanced_power_plot","text":"function (1) estimates informative distribution effect power estimates given datas total sample size, distribution imbalanced sample sizes (2) returns summary plot.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/imbalanced_power_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"binary trait imbalanced design power analysis plot — imbalanced_power_plot","text":"","code":"imbalanced_power_plot(mydata)"},{"path":"https://mrcieu.github.io/metaboprep/reference/imbalanced_power_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"binary trait imbalanced design power analysis plot — imbalanced_power_plot","text":"mydata numeric data matrix samples rows features columns","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/imbalanced_power_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"binary trait imbalanced design power analysis plot — imbalanced_power_plot","text":"ggplot2 object","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/imbalanced_power_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"binary trait imbalanced design power analysis plot — imbalanced_power_plot","text":"","code":"ex_data = matrix(NA, 1000, 2) imbalanced_power_plot( ex_data )"},{"path":"https://mrcieu.github.io/metaboprep/reference/missingness.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Missingness — missingness","title":"Estimate Missingness — missingness","text":"function estimates missingness matrix data provides option exclude certain columns features analysis, xenobiotics (high missingness rates) metabolomics data sets.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/missingness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Missingness — missingness","text":"","code":"missingness(data, by = \"row\")"},{"path":"https://mrcieu.github.io/metaboprep/reference/missingness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Missingness — missingness","text":"data matrix, numeric matrix samples rows features columns character, whether calculate missingness rows (samples) column (features)","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/missingness.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Missingness — missingness","text":"data.frame, data frame missingness estimates sample/feature.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/multivariate_anova.html","id":null,"dir":"Reference","previous_headings":"","what":"multivariate analysis — multivariate_anova","title":"multivariate analysis — multivariate_anova","text":"function performs multivariate analysis dependent|response numerous independent|explanatory variable","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/multivariate_anova.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"multivariate analysis — multivariate_anova","text":"","code":"multivariate_anova(dep, indep_df)"},{"path":"https://mrcieu.github.io/metaboprep/reference/multivariate_anova.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"multivariate analysis — multivariate_anova","text":"dep vector dependent variable indep_df data frame independent variable","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/multivariate_anova.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"multivariate analysis — multivariate_anova","text":"ggplot2 table figure ","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/multivariate_anova.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"multivariate analysis — multivariate_anova","text":"","code":"## simulate some correlated data set.seed(1110) n <- 250 mu <- c(5, 45, 25) cmat <- matrix(c(1, 0.5, 0.3,                  0.5, 1, 0.25,                  0.3, 0.25, 1), nrow = 3, byrow = TRUE) L <- chol(cmat) Z <- matrix(rnorm(n * 3), nrow = n) ex_data <- Z %*% L ex_data <- sweep(ex_data, 2, mu, \"+\") colnames(ex_data) = c(\"outcome\",\"age\",\"bmi\") multivariate_anova(dep = ex_data[,1], indep_df = ex_data[, 2:3])"},{"path":"https://mrcieu.github.io/metaboprep/reference/outlier_detection.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify indexes of outliers in data — outlier_detection","title":"Identify indexes of outliers in data — outlier_detection","text":"Given vector matrix, function returns vector matrix 0|1, structure 1 values indicating outliers.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/outlier_detection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify indexes of outliers in data — outlier_detection","text":"","code":"outlier_detection(data, nsd = 5, meansd = FALSE, by = \"column\")"},{"path":"https://mrcieu.github.io/metaboprep/reference/outlier_detection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify indexes of outliers in data — outlier_detection","text":"data matrix numerical values, samples row, features columns nsd unit distance SD IQR mean median estimate, respectively outliers identified . Default value 5. meansd set TRUE like estimate outliers using mean SD method; set FALSE like estimate medians inter quartile ranges. default FALSE. character, either 'column' compute along columns 'row' compute across rows. Irrelevant vectors.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/outlier_detection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify indexes of outliers in data — outlier_detection","text":"matrix 0 (sample outlier) 1 (outlier)","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/outliers.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify Outliers — outliers","title":"Identify Outliers — outliers","text":"function identifies outliers vector data SD units mean.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/outliers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify Outliers — outliers","text":"","code":"outliers(x, nsd = 3)"},{"path":"https://mrcieu.github.io/metaboprep/reference/outliers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify Outliers — outliers","text":"x numerical vector data nsd number SD units mean used outlier cutoff.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/outliers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify Outliers — outliers","text":"list object length three. (1) vector sample indexes indicating outliers, (2) lower outlier cuttoff value, (3) upper outlier cuttoff value.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/outliers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify Outliers — outliers","text":"","code":"ex_data = rnbinom(500, mu = 40, size = 5) outliers(ex_data) #> [[1]] #> [1] 125 409 455 #>  #> [[2]] #> [1] -16.56037 #>  #> [[3]] #> [1] 95.07637 #>"},{"path":"https://mrcieu.github.io/metaboprep/reference/pc_and_outliers.html","id":null,"dir":"Reference","previous_headings":"","what":"Principal Component Analysis — pc_and_outliers","title":"Principal Component Analysis — pc_and_outliers","text":"function performs principal component analysis. first, missing data imputed median. Subsequent derivation PC, median imputed PC data used identify number informative \"significant\" PC (1) acceleration analysis, (2) parrallel analysis. Finally number sample outliers determined 3, 4, 5 standard deviations mean top PCs determined acceleration factor analysis.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/pc_and_outliers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Principal Component Analysis — pc_and_outliers","text":"","code":"pc_and_outliers(   metaboprep,   source_layer = \"input\",   sample_ids = NULL,   feature_ids = NULL )"},{"path":"https://mrcieu.github.io/metaboprep/reference/pc_and_outliers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Principal Component Analysis — pc_and_outliers","text":"metaboprep object class Metaboprep source_layer character, type/source data use sample_ids character, vector sample ids include, default NULL includes feature_ids character, vector feature ids include, default NULL includes ","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/pc_and_outliers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Principal Component Analysis — pc_and_outliers","text":"data.frame","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/quality_control.html","id":null,"dir":"Reference","previous_headings":"","what":"Metabolite Quality Control — quality_control","title":"Metabolite Quality Control — quality_control","text":"function wrapper function performs key quality controls steps metabolomics data set. Key principles:  1. keep source underlying data  2. copy source data new data layer called qcing processing  3. build exclusion list, accumulating codes exclusion reasons  4. make adjustments needed destination copy data, flag exclusion list  5. copy final result data layer called post_qc  6. return Metabolites object newly populated data layers","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/quality_control.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Metabolite Quality Control — quality_control","text":"","code":"quality_control(   metaboprep,   source_layer = \"input\",   sample_missingness = 0.2,   feature_missingness = 0.2,   total_peak_area_sd = 5,   outlier_udist = 5,   outlier_treatment = \"leave_be\",   winsorize_quantile = 1,   tree_cut_height = 0.5,   feature_selection = \"max_var_exp\",   pc_outlier_sd = 5,   max_num_pcs = 10,   sample_ids = NULL,   feature_ids = NULL,   features_exclude_but_keep = NULL )"},{"path":"https://mrcieu.github.io/metaboprep/reference/quality_control.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Metabolite Quality Control — quality_control","text":"metaboprep object class Metabolites source_layer character, data layer summarise sample_missingness numeric 0-1, percentage data missingness prompt exclusion sample feature_missingness numeric 0-1, percentage data missingness prompt exclusion feature total_peak_area_sd numeric, number TPA SD sample excluded outlier_udist unit distance SD IQR mean median estimate, respectively outliers identified . Default value 5. outlier_treatment character, handle outlier data values - options 'leave_be', 'turn_NA', 'winsorize' winsorize_quantile numeric, quantile winsorize , relevant 'outlier_treatment'='winsorize' tree_cut_height numeric, threshold feature independence hierarchical clustering. Default 0.5. feature_selection character, either 'max_var_exp' 'least_missingness', select independent feature within clusters pc_outlier_sd numeric, number PCA SD sample excluded max_num_pcs numeric, maximum number PCs use (look ) filtering samples PC outlier SD, default=10, set NULL use informative PCs Scree analysis sample_ids character, vector sample ids retain work , others samples excluded feature_ids character, vector feature ids retain work , features excluded features_exclude_but_keep character, vector feature ids indicating features exclude sample PCA quality control analysis keep data, name logical column features data indicating ","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_metabolon.html","id":null,"dir":"Reference","previous_headings":"","what":"Read Metabolon Data — read_metabolon","title":"Read Metabolon Data — read_metabolon","text":"Read Metabolon Data","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_metabolon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read Metabolon Data — read_metabolon","text":"","code":"read_metabolon(   filepath,   sheet = NULL,   feature_sheet = NULL,   feature_id_col = NULL,   sample_sheet = NULL,   sample_id_col = NULL,   return_Metaboprep = TRUE )"},{"path":"https://mrcieu.github.io/metaboprep/reference/read_metabolon.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read Metabolon Data — read_metabolon","text":"filepath character, commercial Metabolon excel sheet extension .xls .xlsx sheet character integer, excel sheet name (index) read. feature_sheet character integer, excel sheet name (index) read feature data. feature_id_col character, excel column containing feature_id mapping data. sample_sheet character integer, excel sheet name (index) read sample data. sample_id_col character, excel column containing sample_id mapping data. return_Metaboprep logical, TRUE (default) return Metaboprep object, FALSE return list.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_metabolon.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read Metabolon Data — read_metabolon","text":"list Metaboprep object, list(data = matrix, samples = samples data.frame, features = features data.frame)","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_metabolon.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read Metabolon Data — read_metabolon","text":"","code":"# version 1.1 data format filepath1 <- system.file(\"extdata\", \"metabolon_v1.1_example.xlsx\", package = \"metaboprep\") m <- read_metabolon(filepath1, sheet = 2)  # version 1.2 data format (different column names) filepath2 <- system.file(\"extdata\", \"metabolon_v1.2_example.xlsx\", package = \"metaboprep\") m <- read_metabolon(filepath2, sheet = 'OrigScale')   # version 2 data format filepath3 <- system.file(\"extdata\", \"metabolon_v2_example.xlsx\", package = \"metaboprep\") m <- read_metabolon(filepath3,                      sheet = 'Batch-normalized Data',                      feature_sheet = 'Chemical Annotation',                      feature_id_col = 'CHEM_ID',                      sample_sheet = 'Sample Meta Data',                      sample_id_col = 'PARENT_SAMPLE_NAME')"},{"path":"https://mrcieu.github.io/metaboprep/reference/read_nightingale.html","id":null,"dir":"Reference","previous_headings":"","what":"Read Nightingale Data (format 1) — read_nightingale","title":"Read Nightingale Data (format 1) — read_nightingale","text":"Read Nightingale Data (format 1)","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_nightingale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read Nightingale Data (format 1) — read_nightingale","text":"","code":"read_nightingale(filepath, return_Metaboprep = TRUE)"},{"path":"https://mrcieu.github.io/metaboprep/reference/read_nightingale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read Nightingale Data (format 1) — read_nightingale","text":"filepath character, commercial Nightingale excel sheet extension .xls .xlsx return_Metaboprep logical, TRUE (default) return Metaboprep object, FALSE return list.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_nightingale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read Nightingale Data (format 1) — read_nightingale","text":"list Metaboprep object, list(data = matrix, samples = samples data.frame, features = features data.frame)","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_nightingale.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read Nightingale Data (format 1) — read_nightingale","text":"","code":"# version 1 data format filepath1 <- system.file(\"extdata\", \"nightingale_v1_example.xlsx\", package = \"metaboprep\") m <- read_nightingale(filepath1)  # version 2 data format filepath2 <- system.file(\"extdata\", \"nightingale_v2_example.xlsx\", package = \"metaboprep\") m <- read_nightingale(filepath2)"},{"path":"https://mrcieu.github.io/metaboprep/reference/read_olink.html","id":null,"dir":"Reference","previous_headings":"","what":"Read and Process Olink NPX Data File — read_olink","title":"Read and Process Olink NPX Data File — read_olink","text":"function reads processes Olink NPX file long format. supports `.csv`, `.xls`, `.xlsx`, `.txt`, `.zip`, `.parquet` formats, using Olink's OlinkAnalyze::read_NPX() function, returns metaboprep object list matrices metadata frames analysis.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_olink.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read and Process Olink NPX Data File — read_olink","text":"","code":"read_olink(filepath, return_Metaboprep = FALSE)"},{"path":"https://mrcieu.github.io/metaboprep/reference/read_olink.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read and Process Olink NPX Data File — read_olink","text":"filepath string specifying path Olink NPX file. return_Metaboprep logical, TRUE (default) return Metaboprep object, FALSE return list.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_olink.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read and Process Olink NPX Data File — read_olink","text":"Metaboprep object named list following elements: data matrix NPX values `SampleID` rows `OlinkID` columns, containing sample data. samples `data.frame` containing metadata samples. features `data.frame` containing feature-level metadata samples. controls matrix NPX values control samples. control_metadata `data.frame` containing metadata control samples.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_olink.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read and Process Olink NPX Data File — read_olink","text":"function checks whether input data long format verifying presence duplicate `SampleID` values. also accommodates two variants Olink files: Files include `Sample_Type` column values `\"SAMPLE\"` `\"CONTROL\"`. Files use `SampleID` column label control samples (e.g., entries containing `\"CONTROL\"`). neither format detected, function stops error indicating data likely Olink.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_olink.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read and Process Olink NPX Data File — read_olink","text":"","code":"if (FALSE) { # \\dontrun{   filepath <- system.file(\"extdata\", \"example_olink_data.txt\", package = \"metaboprep\")   olink_data <- read_olink(filepath) } # }"},{"path":"https://mrcieu.github.io/metaboprep/reference/read_somalogic.html","id":null,"dir":"Reference","previous_headings":"","what":"Read and Process SomaLogic adat file — read_somalogic","title":"Read and Process SomaLogic adat file — read_somalogic","text":"function reads processes commercial SomaLogic `.adat` file. extracts RFU (Relative Florecent Units) data samples controls, along respective metadata feature (protein) metadata. function returns structured list suitable analysis.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_somalogic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read and Process SomaLogic adat file — read_somalogic","text":"","code":"read_somalogic(filepath, return_Metaboprep = FALSE)"},{"path":"https://mrcieu.github.io/metaboprep/reference/read_somalogic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read and Process SomaLogic adat file — read_somalogic","text":"filepath string specifying path SomaLogic `.adat` file. return_Metaboprep logical, TRUE (default) return Metaboprep object, FALSE return list.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_somalogic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read and Process SomaLogic adat file — read_somalogic","text":"metaboprep object named list following elements: data matrix RFU values experimental samples, `SampleId`         row names `SeqId` (columns containing \"seq\") column names. samples `tibble` containing metadata experimental samples,         `sample_id` (renamed `SampleId`) first column. features `tibble` containing feature-level metadata (e.g., protein         details), including newly created `feature_id` column derived `SeqId`. controls matrix RFU values control samples (specifically \"Calibrator\"         samples), `SampleId` row names `SeqId` column names. control_metadata `tibble` containing metadata control samples         (specifically \"Calibrator\" samples), `sample_id` first column.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_somalogic.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read and Process SomaLogic adat file — read_somalogic","text":"function performs several validation steps data transformations: first checks provided `filepath` points `.adat` file. uses `SomaDataIO::read_adat()` import raw data         `SomaDataIO::.soma_adat()` verify integrity SomaLogic object. confirms presence crucial `SampleId` column. Data separated experimental \"Sample\" \"Calibrator\" control groups based `SampleType` column. sample control data, RFU values corresponding \"seq\" columns         extracted reshaped wide matrices `SampleId` row names. Feature metadata extracted `attr(df, \"Col.Meta\")`, new         `feature_id` column created (prefixed \"seq.\" hyphens replaced periods). Sample control metadata extracted `attr(df, \"row_meta\")`,         converted `tibble`s, renamed, `sample_id` relocated front.         Explicit `tibble::as_tibble()` `tibble::remove_rownames()` used         handle potential `SomaDataIO` object intricacies.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/read_somalogic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read and Process SomaLogic adat file — read_somalogic","text":"","code":"if (FALSE) { # \\dontrun{   filepath <- system.file(\"extdata\", \"example_data10.adat\", package = \"SomaDataIO\")   somalogic_data <- read_somalogic(filepath) } # }"},{"path":"https://mrcieu.github.io/metaboprep/reference/run_metaboprep1.html","id":null,"dir":"Reference","previous_headings":"","what":"Metaboprep 1 pipeline — run_metaboprep1","title":"Metaboprep 1 pipeline — run_metaboprep1","text":"function runs original metaboprep1 pipeline using old parameter file input format. function requires access internet old package (default github commit `bbe1f85`) dynamically downloaded used process data.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/run_metaboprep1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Metaboprep 1 pipeline — run_metaboprep1","text":"","code":"run_metaboprep1(parameter_file, gitcommit = \"bbe1f85\", attempt_report = FALSE)"},{"path":"https://mrcieu.github.io/metaboprep/reference/run_metaboprep1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Metaboprep 1 pipeline — run_metaboprep1","text":"parameter_file character, full file path metaboprep 1 parameter file gitcommit character, Github commit - default pinned last stable metaboprep 1 version `bbe1f85` attempt_report logical, whether attempt metaboprep1 report generation. Default=FALSE can lead errors operating systems.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/sample_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample Summary Statistics — sample_summary","title":"Sample Summary Statistics — sample_summary","text":"Summarise sample data","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/sample_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample Summary Statistics — sample_summary","text":"","code":"sample_summary(   metaboprep,   source_layer = \"input\",   outlier_udist = 5,   sample_ids = NULL,   feature_ids = NULL,   output = \"data.frame\" )"},{"path":"https://mrcieu.github.io/metaboprep/reference/sample_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample Summary Statistics — sample_summary","text":"metaboprep object class Metaboprep source_layer character, data layer summarise outlier_udist unit distance SD IQR mean median estimate, respectively outliers identified . Default value 5. sample_ids character, vector sample ids work feature_ids character, vector feature ids work output character, type output, either 'object' return updated metaboprep object, 'data.frame' return data.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/shiny_app.html","id":null,"dir":"Reference","previous_headings":"","what":"Metaboprep Shiny App — shiny_app","title":"Metaboprep Shiny App — shiny_app","text":"Launch Shiny app explore Metaboprep object","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/shiny_app.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Metaboprep Shiny App — shiny_app","text":"","code":"shiny_app(metaboprep)"},{"path":"https://mrcieu.github.io/metaboprep/reference/shiny_app.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Metaboprep Shiny App — shiny_app","text":"metaboprep object class Metaboprep","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/shiny_app.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Metaboprep Shiny App — shiny_app","text":"Runs Shiny app","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/summarise.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary Statistics — summarise","title":"Summary Statistics — summarise","text":"Summarise sample feature data","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/summarise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary Statistics — summarise","text":"","code":"summarise(   metaboprep,   source_layer = \"input\",   outlier_udist = 5,   tree_cut_height = 0.5,   feature_selection = \"max_var_exp\",   sample_ids = NULL,   feature_ids = NULL,   features_exclude = NULL,   output = \"data.frame\" )"},{"path":"https://mrcieu.github.io/metaboprep/reference/summarise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary Statistics — summarise","text":"metaboprep object class Metaboprep source_layer character, data layer summarise outlier_udist unit distance SD IQR mean median estimate, respectively outliers identified . Default value 5. tree_cut_height numeric, threshold feature independence hierarchical clustering. Default 0.5. feature_selection character, either 'max_var_exp' 'least_missingness', select independent feature within clusters sample_ids character, vector sample ids work feature_ids character, vector feature ids work features_exclude character, vector feature id indicating features exclude sample PCA summary analysis keep data output character, type output, either 'object' return updated metaboprep object, 'data.frame' return data.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/summary.Metaboprep.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary Method for Metaboprep Object — summary.Metaboprep","title":"Summary Method for Metaboprep Object — summary.Metaboprep","text":"Provides concise, human-readable summary `Metaboprep` object. reports key dimensions data, presence metadata columns, number data layers, status quality control summaries exclusions.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/summary.Metaboprep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary Method for Metaboprep Object — summary.Metaboprep","text":"object `Metaboprep` object. ... Additional arguments (used).","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/summary.Metaboprep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary Method for Metaboprep Object — summary.Metaboprep","text":"Invisibly returns NULL. Prints formatted summary console.","code":""},{"path":[]},{"path":"https://mrcieu.github.io/metaboprep/reference/total_peak_area.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimates total peak abundance — total_peak_area","title":"Estimates total peak abundance — total_peak_area","text":"function estimates total peak abundance|area numeric data matrix, (1) features (2) features complete data.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/total_peak_area.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimates total peak abundance — total_peak_area","text":"","code":"total_peak_area(data, ztransform = TRUE)"},{"path":"https://mrcieu.github.io/metaboprep/reference/total_peak_area.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimates total peak abundance — total_peak_area","text":"data matrix, metabolite data matrix. Samples rows, metabolites columns ztransform logical, feature data z-transformed absolute value minimum, mean shifted prior summing feature values. TRUE FALSE.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/total_peak_area.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimates total peak abundance — total_peak_area","text":"data frame estimates (1) total peak abundance (2) total peak abundance complete features samples","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/tree_and_independent_features.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify Independent Features in a Numeric Matrix — tree_and_independent_features","title":"Identify Independent Features in a Numeric Matrix — tree_and_independent_features","text":"function identifies independent features using Spearman's rho correlation distances, dendrogram tree cut step.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/tree_and_independent_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify Independent Features in a Numeric Matrix — tree_and_independent_features","text":"","code":"tree_and_independent_features(   data,   tree_cut_height = 0.5,   features_exclude = NULL,   feature_selection = \"max_var_exp\" )"},{"path":"https://mrcieu.github.io/metaboprep/reference/tree_and_independent_features.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify Independent Features in a Numeric Matrix — tree_and_independent_features","text":"data matrix, metabolite data matrix. samples row, metabolites columns tree_cut_height tree cut height. value 0.2 (1-Spearman's rho) equivalent saying features rho >= 0.8 independent. features_exclude character, vector feature id indicating features exclude sample PCA summary analysis keep data feature_selection character. Method selecting representative feature correlated feature cluster. One : \"max_var_exp\" (Default) Selects feature highest sum absolute Spearman correlations features cluster;   effectively feature explaining shared variance. \"least_missingness\" Selects feature fewest missing values within cluster.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/tree_and_independent_features.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify Independent Features in a Numeric Matrix — tree_and_independent_features","text":"list following components: data `data.frame` : `feature_id`: Feature (column) names input matrix. `k`: cluster index assigned feature tree cutting. `independent_features`: Logical indicator whether feature selected independent (representative) feature.  tree `hclust` object representing hierarchical clustering features based 1 - |Spearman's rho| distance.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/variable_by_factor.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 violin plot — variable_by_factor","title":"ggplot2 violin plot — variable_by_factor","text":"function performs univariate linear analysis dependent independent variable generates viloin box plot illustrate associated structure.","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/variable_by_factor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 violin plot — variable_by_factor","text":"","code":"variable_by_factor(   dep,   indep,   dep_name = \"dependent\",   indep_name = \"independent\",   orderfactor = TRUE,   violin = TRUE )"},{"path":"https://mrcieu.github.io/metaboprep/reference/variable_by_factor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 violin plot — variable_by_factor","text":"dep vector dependent variable indep vector independent variable dep_name name dependent variable indep_name name independent variable orderfactor order factors alphebetically violin box plot violin plot. violin = TRUE default","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/variable_by_factor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2 violin plot — variable_by_factor","text":"ggplot2 object","code":""},{"path":"https://mrcieu.github.io/metaboprep/reference/variable_by_factor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ggplot2 violin plot — variable_by_factor","text":"","code":"x = c( rnorm(20, 10, 2), rnorm(20, 20, 2) ) y = as.factor( c( rep(\"A\", 20), rep(\"B\", 20)  ) ) variable_by_factor(dep = x , indep = y, dep_name = \"expression\", indep_name = \"species\" )"}]
