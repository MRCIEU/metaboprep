% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read_nightingale.R
\name{read_nightingale}
\alias{read_nightingale}
\title{Read Nightingale Data (format 1)
Reads and processes a commercial Nightingale Excel sheet in format version 1 or 2. Returns either a structured `Metaboprep` object or a list of components.}
\usage{
read_nightingale(filepath, return_Metaboprep = TRUE)
}
\arguments{
\item{filepath}{character, commercial Nightingale excel sheet with extension .xls or .xlsx}

\item{return_Metaboprep}{logical, if TRUE (default) return a Metaboprep object, if FALSE return a list.}
}
\value{
Metaboprep object or list,  list(data = 3D matrix, samples = samples data.table, features = features data.table)

If `return_Metaboprep = TRUE` (default), returns a `Metaboprep` object containing the input data.
If `return_Metaboprep = FALSE`, returns a named list with the following elements:
\describe{
  \item{data}{A numeric matrix of metabolite values with samples as rows and features as columns.}
  \item{samples}{A `data.frame` containing metadata for each sample (must include `sample_id`).}
  \item{features}{A `data.frame` containing metadata for each metabolite feature (must include `feature_id`).}
}
}
\description{
Read Nightingale Data (format 1)
Reads and processes a commercial Nightingale Excel sheet in format version 1 or 2. Returns either a structured `Metaboprep` object or a list of components.
}
\details{
This function reads a commercial Nightingale Excel file in either single-sheet (v1/v2) or multi-sheet (v3) format.
It extracts sample-level and feature-level metadata alongside the numeric data matrix.
Users can choose to return either a structured `Metaboprep` S7 object or a basic list via the `return_Metaboprep` parameter.
}
\examples{
# version 1 data format
filepath1 <- system.file("extdata", "nightingale_v1_example.xlsx", package = "metaboprep")
m <- read_nightingale(filepath1)

# version 2 data format
filepath2 <- system.file("extdata", "nightingale_v2_example.xlsx", package = "metaboprep")
m <- read_nightingale(filepath2)

}
